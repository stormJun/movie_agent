# 第一次对话

> **目标读者**：项目新手
> **阅读时间**：10 分钟
> **前置知识**：已完成[安装指南](./安装指南.md)和[第一次构建知识图谱](./第一次构建知识图谱.md)
> **难度等级**：⭐

## 📋 本文大纲

- [1. 启动后端服务](#1-启动后端服务)
- [2. 启动前端界面](#2-启动前端界面)
- [3. 选择 Agent](#3-选择-agent)
- [4. 进行第一次对话](#4-进行第一次对话)
- [5. 使用调试模式](#5-使用调试模式)
- [6. 终端测试](#6-终端测试)

---

## 1. 启动后端服务

### 1.1 启动 FastAPI 后端

```bash
# 确保在项目根目录
cd graph-rag-agent

# 激活 Python 环境
conda activate graphrag

# 启动后端服务
bash scripts/dev.sh backend
```

### 1.2 验证后端启动

看到以下输出表示启动成功：

```
INFO:     Started server process [xxxxx]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8324 (Press CTRL+C to quit)
```

**访问 API 文档**：http://localhost:8324/docs

---

## 2. 启动前端界面

### 2.1 打开新终端并启动 Streamlit

**重要**：保持后端服务运行，打开**新的终端窗口**。

```bash
# 进入项目目录
cd graph-rag-agent

# 激活 Python 环境
conda activate graphrag

# 启动前端
streamlit run frontend/app.py
```

### 2.2 访问前端界面

启动成功后会自动打开浏览器，或手动访问：

**前端地址**：http://localhost:8501

---

## 3. 选择 Agent

### 3.1 可用的 Agent 类型

项目提供 **5 种 Agent**，适用于不同场景：

| Agent | 难度 | 速度 | 适用场景 | 推荐度 |
|-------|------|------|----------|--------|
| **NaiveRagAgent** | ⭐ | 🚀🚀🚀 | 简单问答，直接匹配文档 | ⭐⭐⭐ 新手推荐 |
| **GraphAgent** | ⭐⭐ | 🚀🚀 | 需要图结构推理的问题 | ⭐⭐⭐⭐ |
| **HybridAgent** | ⭐⭐⭐ | 🚀 | 复杂问题，结合多种搜索 | ⭐⭐⭐⭐⭐ 推荐 |
| **DeepResearchAgent** | ⭐⭐⭐⭐ | 🐢 | 深度研究，多步推理 | ⭐⭐⭐⭐ |
| **FusionGraphRAGAgent** | ⭐⭐⭐⭐ | 🐢🐢 | 最复杂问题，长文档生成 | ⭐⭐⭐⭐⭐ 高级用户 |

### 3.2 Agent 对比详解

#### NaiveRagAgent（朴素 RAG）

**工作原理**：
- 向量检索相关文档
- 直接返回答案

**适用问题**：
- "国家奖学金的金额是多少？"
- "旷课多少学时会被处分？"

**优点**：速度快、简单直接
**缺点**：无法处理复杂推理

#### GraphAgent（图 Agent）

**工作原理**：
- 基于知识图谱进行推理
- 利用实体和关系回答

**适用问题**：
- "国家奖学金和励志奖学金有什么区别？"
- "优秀学生需要满足哪些条件？"

**优点**：支持关系推理
**缺点**：依赖图谱质量

#### HybridAgent（混合 Agent）⭐ 推荐

**工作原理**：
- 结合向量检索、图谱检索、社区检索
- 多策略融合

**适用问题**：
- "哪些奖学金是互斥的？"
- "学生违纪后有哪些申诉途径？"

**优点**：准确度高、鲁棒性强
**缺点**：速度稍慢

#### DeepResearchAgent（深度研究）

**工作原理**：
- 多步思考-搜索-推理循环
- Chain of Exploration 图谱探索

**适用问题**：
- "如何从普通学生成为优秀毕业生？"
- "奖学金评定的完整流程是什么？"

**优点**：深度推理、可解释性强
**缺点**：耗时较长（30秒-2分钟）

#### FusionGraphRAGAgent（融合多智能体）

**工作原理**：
- Plan-Execute-Report 架构
- 任务分解、并行执行、长文档生成

**适用问题**：
- "撰写一篇关于奖学金体系的完整报告"
- "详细分析学生管理制度的所有方面"

**优点**：最强大、支持长文档
**缺点**：耗时最长（1-3分钟）

### 3.3 如何选择 Agent

**首次使用建议**：
1. 先用 **NaiveRagAgent** 测试简单问题
2. 再用 **HybridAgent** 测试复杂问题
3. 最后尝试 **DeepResearchAgent** 体验深度推理

**实际使用建议**：
- 日常问答：HybridAgent
- 复杂研究：DeepResearchAgent
- 报告生成：FusionGraphRAGAgent

---

## 4. 进行第一次对话

### 4.1 基本操作

1. **选择 Agent**：在侧边栏选择 "NaiveRagAgent"
2. **输入问题**：在文本框输入您的问题
3. **发送**：点击发送或按 Enter

### 4.2 示例对话

#### 示例 1：简单问答（NaiveRagAgent）

**问题**：
```
旷课多少学时会被退学？
```

**预期回答**：
```
根据学生管理规定，学生在一学期内旷课累计达到 50 学时，
学校将给予退学处理。此外，连续旷课两周（按每周 20 学时计算，
即 40 学时）也会被退学。

[来源：学生纪律处分管理规定 第X条]
```

#### 示例 2：关系推理（GraphAgent）

**问题**：
```
国家奖学金和国家励志奖学金可以同时申请吗？
```

**预期回答**：
```
不可以。国家奖学金和国家励志奖学金是互斥的，学生在同一学年
只能申请其中一种。两者的主要区别是：

- 国家奖学金：8000元/年，面向学习成绩特别优秀的学生
- 国家励志奖学金：5000元/年，面向品学兼优的家庭经济困难学生

[知识图谱关系：国家奖学金 -- 互斥 --> 国家励志奖学金]
```

#### 示例 3：深度研究（DeepResearchAgent）

**问题**：
```
优秀学生的申请条件是什么？
```

**预期回答**：
```
【思考步骤】
1. 搜索"优秀学生"的定义和标准
2. 查找申请流程相关规定
3. 综合分析评定条件

【答案】
优秀学生的申请条件包括：

一、学习成绩要求：
- 学分绩点排名在专业前 10%
- 无挂科记录

二、思想品德要求：
- 德育考核成绩 80 分以上
- 无违纪处分记录

三、其他要求：
- 积极参与社会实践和志愿服务
- 担任学生干部优先

【证据来源】
- 学生手册第X章
- 奖学金评定办法第Y条
```

---

## 5. 使用调试模式

### 5.1 开启调试模式

在前端侧边栏勾选 "调试模式"。

### 5.2 调试模式功能

开启后可以看到：

1. **执行轨迹**：LangGraph 节点执行顺序
2. **搜索过程**：命中的知识图谱节点和关系
3. **文档源**：回答来源的原始文档片段
4. **知识图谱可视化**：交互式图谱展示

### 5.3 调试示例

![调试模式示例](../../assets/web-debug1.png)

可以看到：
- Agent 的思考步骤
- 调用了哪些搜索工具
- 找到了哪些实体和关系
- 原始文档内容

---

## 6. 终端测试

如果不想使用前端，可以直接在终端测试。

### 6.1 非流式测试

```bash
cd graph-rag-agent/test

# 编辑 search_without_stream.py，设置您的问题
# 然后运行
python search_without_stream.py
```

### 6.2 流式测试

```bash
cd graph-rag-agent/test

# 流式输出，实时显示生成过程
python search_with_stream.py
```

### 6.3 自定义测试

编辑 `test/search_with_stream.py`：

```python
TEST_CONFIG = {
    "queries": [
        "旷课多少学时会被退学？",
        "国家奖学金和国家励志奖学金互斥吗？",
        "优秀学生要怎么申请？",
        # 添加您的问题
    ],
    "max_wait_time": 300
}

# 注释掉不想测试的 Agent
agents_to_test = [
    # ("NaiveRagAgent", naive_rag_agent),
    ("HybridAgent", hybrid_agent),
    # ("DeepResearchAgent", deep_research_agent),
]
```

---

## ✅ 完成第一次对话！

恭喜！您已成功完成从安装到对话的完整流程。

**下一步探索**：
- [前端界面使用](../05-功能与使用/前端界面使用.md) - 深入了解前端功能
- [Agent 系统](../02-核心机制/02-核心子系统/Agent系统.md) - 理解 Agent 架构
- [API 使用指南](../05-功能与使用/API使用指南.md) - 通过 API 集成

---

## 🔗 相关文档

- [调试模式](../05-功能与使用/调试模式.md) - 详细调试功能说明
- [多 Agent 协作](../02-核心机制/03-关键特性/多Agent协作.md) - 理解多智能体架构
- [Chain of Exploration](../02-核心机制/03-关键特性/Chain-of-Exploration.md) - 深度搜索原理

---

## 📝 更新日志

- 2026-01-04: 初始版本

**返回**: [快速开始首页](./README.md) | [文档首页](../README.md)
