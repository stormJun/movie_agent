# ç³»ç»Ÿæ¶æ„æ€»è§ˆ

---

## ğŸ“‹ å…ƒä¿¡æ¯

- **ç›®æ ‡è¯»è€…**ï¼šæ‰€æœ‰è¯»è€…ï¼ˆå¼€å‘è€…ã€æ¶æ„å¸ˆã€äº§å“ç»ç†ï¼‰
- **é˜…è¯»æ—¶é—´**ï¼š15åˆ†é’Ÿ
- **éš¾åº¦**ï¼šâ­â­
- **å‰ç½®çŸ¥è¯†**ï¼šåŸºç¡€è½¯ä»¶æ¶æ„æ¦‚å¿µ
- **æœ€åæ›´æ–°**ï¼š2026-01-04

---

## ğŸ“– æœ¬æ–‡å¤§çº²

- [æ•´ä½“æ¶æ„å›¾](#æ•´ä½“æ¶æ„å›¾)
- [ä¸‰å¤§æ ¸å¿ƒæ¨¡å—](#ä¸‰å¤§æ ¸å¿ƒæ¨¡å—)
- [æ ¸å¿ƒå¼•æ“ä¸å…³é”®å­ç³»ç»Ÿè¯¦è§£](#æ ¸å¿ƒå¼•æ“ä¸å…³é”®å­ç³»ç»Ÿè¯¦è§£)
- [æŠ€æœ¯æ ˆè¯´æ˜](#æŠ€æœ¯æ ˆè¯´æ˜)
- [æ¨¡å—èŒè´£ä¸äº¤äº’](#æ¨¡å—èŒè´£ä¸äº¤äº’)
- [éƒ¨ç½²æ¶æ„](#éƒ¨ç½²æ¶æ„)
- [ç›¸å…³æ–‡æ¡£](#ç›¸å…³æ–‡æ¡£)

---

## æ•´ä½“æ¶æ„å›¾

æœ¬é¡¹ç›®é‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œæ¸…æ™°åˆ†ç¦» APIã€ç”¨ä¾‹ç¼–æ’ã€é¢†åŸŸæ¨¡å‹ã€åŸºç¡€è®¾æ–½ä¸æ ¸å¿ƒç®—æ³•å±‚ï¼Œä¾¿äº GraphRAG ç‹¬ç«‹æœåŠ¡åŒ–ï¼š

```mermaid
graph TB
    subgraph ç”¨æˆ·å±‚[ç”¨æˆ·äº¤äº’å±‚]
        U1[ğŸ‘¤ ç»ˆç«¯ç”¨æˆ·<br/>å­¦ç”Ÿ/æ•™å¸ˆ/ç®¡ç†å‘˜]
        U2[ğŸ‘¨â€ğŸ’» å¼€å‘è€…<br/>APIè°ƒç”¨/é›†æˆ]
    end

    subgraph è¡¨ç¤ºå±‚[è¡¨ç¤ºå±‚ Presentation Layer]
        F1[ğŸ–¥ï¸ Streamlitå‰ç«¯<br/>frontend/]
        F2[ğŸ”Œ FastAPIæœåŠ¡<br/>backend/server/]
    end

    subgraph æœåŠ¡å±‚[æœåŠ¡å±‚ Service Layer]
        direction TB

        subgraph APP[backend/application/ ç”¨ä¾‹ç¼–æ’]
            A1[Chat/Stream/KG/Feedback]
        end

        subgraph DOM[backend/domain/ é¢†åŸŸæ¨¡å‹]
            D0[Entities/RouteDecision/Plans]
        end

        subgraph INF[backend/infrastructure/ é€‚é…å®ç°]
            I0[Routing/RAG/Models/Persistence/DB]
        end

        subgraph CORE[backend/graphrag_agent/ RAG Core]
            C0[Agents/Search/Graph/Community/Pipelines]
        end

        subgraph TOOLS[tools/ è¿ç»´å…¥å£]
            T1[build]
            T2[evaluation]
        end
    end

    subgraph æ•°æ®å±‚[æ•°æ®å±‚ Data Layer]
        D1[(Neo4j<br/>å›¾æ•°æ®åº“)]
        D2[ğŸ”¢ Vector Index<br/>å‘é‡ç´¢å¼•]
        D3[(Postgres<br/>ä¼šè¯/åé¦ˆ)]
        D4[ğŸ“ File System<br/>æ–‡ä»¶ç³»ç»Ÿ]
    end

    %% ç”¨æˆ·äº¤äº’
    U1 --> F1
    U2 --> F2
    F1 --> F2

    %% è¡¨ç¤ºå±‚åˆ°æœåŠ¡å±‚
    F2 --> A1
    A1 --> D0
    A1 --> I0
    I0 --> C0

    %% æœåŠ¡å±‚åˆ°æ•°æ®å±‚
    I0 --> D1
    I0 --> D2
    I0 --> D3
    I0 --> D4
    T1 --> I0
    T2 --> C0

    style CORE fill:#e1f5ff,stroke:#0066cc,stroke-width:3px
    style è¡¨ç¤ºå±‚ fill:#fff4e1,stroke:#ff9800
    style æ•°æ®å±‚ fill:#e8f5e9,stroke:#4caf50
```

---

## ä¸‰å¤§æ ¸å¿ƒæ¨¡å—

### 1. backend/graphrag_agent/ - æ ¸å¿ƒç®—æ³•åŒ…

**å®šä½**ï¼šRAG æ ¸å¿ƒç®—æ³•ä¸æµç¨‹ï¼Œä¸åŒ…å«å…·ä½“åŸºç¡€è®¾æ–½å®ç°ï¼ˆLLM/DB/ç¼“å­˜/æœåŠ¡æ¡†æ¶ï¼‰ã€‚

**ç‰¹ç‚¹**ï¼š
- å¯ç‹¬ç«‹æŠ½å–ä¸ºåº“æˆ–æœåŠ¡æ ¸å¿ƒ
- ä¸ä¾èµ– FastAPI/Neo4j/LLM/æ•°æ®åº“å®¢æˆ·ç«¯
- é€šè¿‡ ports/adapters ç”±ä¸Šå±‚æ³¨å…¥ä¾èµ–

**æ ¸å¿ƒæ¨¡å—æ¦‚è§ˆ**ï¼š

```mermaid
mindmap
  root((graphrag_agent))
    agents
      BaseAgentåŸºç±»
      5ç§Agentå®ç°
      å¤šæ™ºèƒ½ä½“ç¼–æ’
      LangGraphå·¥ä½œæµ
    graph
      å®ä½“å…³ç³»æå–
      å®ä½“æ¶ˆæ­§å¯¹é½
      ç´¢å¼•ç­–ç•¥æŠ½è±¡
    search
      Local Search
      Global Search
      Hybrid Search
      DeepResearchå·¥å…·
    community
      Leidenç®—æ³•
      SLLPAç®—æ³•
      ç¤¾åŒºæ‘˜è¦ç”Ÿæˆ
    pipelines
      æ–‡æ¡£è§£ææµç¨‹
      æ–‡æœ¬åˆ†å—
      å…ƒæ•°æ®æå–
```

> ç¼“å­˜/æ¨¡å‹å®¢æˆ·ç«¯/é…ç½®/è¯„ä¼°ç­‰èƒ½åŠ›å·²ä¸‹æ²‰åˆ° `backend/infrastructure/` ä¸ `tools/`ã€‚

### 2. GraphRAG æœåŠ¡å±‚ï¼ˆserver + application + infrastructureï¼‰

**å®šä½**ï¼šåŸºäº FastAPI çš„ GraphRAG æœåŠ¡å…¥å£ï¼ŒAPI + ç”¨ä¾‹ç¼–æ’ + ç«¯å£å®ç°ã€‚

**ç›®å½•ç»“æ„**ï¼š
```
backend/server/
â”œâ”€â”€ main.py                 # FastAPIåº”ç”¨å…¥å£
â”œâ”€â”€ api/                    # REST API
â”œâ”€â”€ models/                 # è¯·æ±‚/å“åº”æ¨¡å‹
â”‚   â””â”€â”€ schemas.py          # Schema
```

**ç›¸å…³å±‚ï¼ˆé¡¶å±‚åŒ…ï¼‰**ï¼š
- `backend/application/`ï¼šç”¨ä¾‹ç¼–æ’ + ports
- `backend/infrastructure/`ï¼šç«¯å£å®ç°ï¼ˆRAG/è·¯ç”±/æ¨¡å‹/ç¼“å­˜/DBï¼‰
- `backend/config/`ï¼šæœåŠ¡é…ç½®ï¼ˆsettings/database/ragï¼‰

**æ ¸å¿ƒAPIç«¯ç‚¹**ï¼š

| ç«¯ç‚¹ | æ–¹æ³• | åŠŸèƒ½ | è¿”å› |
|------|------|------|------|
| `/api/v1/chat` | POST | æ™ºèƒ½é—®ç­” | æµå¼/éæµå¼ç­”æ¡ˆ |
| `/api/v1/chat/stream` | POST | æµå¼é—®ç­” | SSE äº‹ä»¶æµ |

### 3. frontend/ - å‰ç«¯ç•Œé¢

**å®šä½**ï¼šåŸºäºStreamlitçš„Webäº¤äº’ç•Œé¢ã€‚

**ç›®å½•ç»“æ„**ï¼š
```
frontend/
â”œâ”€â”€ app.py                  # Streamlitåº”ç”¨å…¥å£
â”œâ”€â”€ components/             # UIç»„ä»¶
â”‚   â”œâ”€â”€ sidebar.py          # ä¾§è¾¹æ ï¼ˆAgenté€‰æ‹©ã€å‚æ•°é…ç½®ï¼‰
â”‚   â”œâ”€â”€ chat_interface.py   # èŠå¤©ç•Œé¢
â”‚   â””â”€â”€ graph_view.py       # å›¾è°±å¯è§†åŒ–ç»„ä»¶
â”œâ”€â”€ utils/                  # å‰ç«¯å·¥å…·
â”‚   â””â”€â”€ api.py              # åç«¯APIè°ƒç”¨å°è£…
â””â”€â”€ frontend_config/                # å‰ç«¯é…ç½®
    â””â”€â”€ settings.py         # è‡ªåŠ¨ç»§æ‰¿æœåŠ¡é…ç½®
```

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- ğŸ’¬ èŠå¤©ç•Œé¢ï¼šæ”¯æŒæµå¼/éæµå¼è¾“å‡º
- ğŸ” è°ƒè¯•æ¨¡å¼ï¼šæ˜¾ç¤ºæ¨ç†è½¨è¿¹ã€æ£€ç´¢è¿‡ç¨‹
- ğŸ“Š å›¾è°±å¯è§†åŒ–ï¼šNeo4jé£æ ¼äº¤äº’å¼å›¾è°±
- âš™ï¸ å‚æ•°è°ƒæ•´ï¼šå®æ—¶è°ƒæ•´Agentè¡Œä¸º
- ğŸ“ åé¦ˆæ”¶é›†ï¼šç‚¹èµ/ç‚¹è¸©æœºåˆ¶

---

## æ ¸å¿ƒå¼•æ“ä¸å…³é”®å­ç³»ç»Ÿè¯¦è§£

æœ¬èŠ‚è¦†ç›– `graphrag_agent` çš„æ ¸å¿ƒç®—æ³•ï¼Œä»¥åŠä¸ä¹‹é…å¥—çš„åŸºç¡€è®¾æ–½ä¸å·¥å…·å­ç³»ç»Ÿï¼ŒèŒè´£ä»¥åˆ†å±‚è¾¹ç•Œä¸ºå‡†ã€‚

### 1. agents/ - æ™ºèƒ½ä½“ç³»ç»Ÿ

**æ¶æ„è®¾è®¡**ï¼š

```mermaid
graph TB
    subgraph BaseAgent[BaseAgent åŸºç±»]
        B1[åŒLLMå®ä¾‹<br/>llm + stream_llm]
        B2[åŒå±‚ç¼“å­˜<br/>session + global]
        B3[LangGraphå·¥ä½œæµ<br/>StateGraph]
        B4[æ€§èƒ½æŒ‡æ ‡æ”¶é›†]
    end

    subgraph Agents[5ç§Agentå®ç°]
        A1[NaiveRagAgent<br/>å‘é‡æ£€ç´¢]
        A2[GraphAgent<br/>å›¾è°±æ¨ç†]
        A3[HybridAgent<br/>æ··åˆæ£€ç´¢]
        A4[DeepResearchAgent<br/>å¤šæ­¥æ¨ç†]
        A5[FusionGraphRAGAgent<br/>Plan-Execute-Report]
    end

    subgraph MultiAgent[å¤šæ™ºèƒ½ä½“ç¼–æ’ multi_agent/]
        M1[planner/<br/>è®¡åˆ’ç”Ÿæˆ]
        M2[executor/<br/>ä»»åŠ¡æ‰§è¡Œ]
        M3[reporter/<br/>æŠ¥å‘Šç”Ÿæˆ]
        M4[core/<br/>æ•°æ®æ¨¡å‹]
        M5[tools/<br/>å·¥å…·ç»„ä»¶]
    end

    BaseAgent --> Agents
    A5 --> MultiAgent

    style BaseAgent fill:#9f9,stroke:#333
    style A5 fill:#ff9,stroke:#333
```

**å…³é”®æŠ€æœ¯**ï¼š
- **retrieve-only**ï¼šAgent åªè´Ÿè´£æ£€ç´¢ï¼Œè¿”å›ç»“æ„åŒ–è¯æ®ï¼ˆä¸åœ¨ core å†…åšå¯¹è¯ç¼–æ’ï¼‰
- **ports æ³¨å…¥**ï¼šLLM/DB/å‘é‡ç´¢å¼•ç­‰é€šè¿‡ ports/provider åœ¨è¿è¡Œæ—¶æ³¨å…¥
- **æœåŠ¡ä¾§ç¼–æ’**ï¼šRouter-Worker / streaming / memory / persistence ç”± `backend/` æœåŠ¡ä¾§è´Ÿè´£

**ä»£ç ç¤ºä¾‹**ï¼ˆç›®æ ‡å½¢æ€ï¼šä¾èµ–ç”±åŸºç¡€è®¾æ–½æ³¨å…¥ï¼‰ï¼š
```python
# BaseAgentï¼ˆv3 strictï¼‰æ ¸å¿ƒç»“æ„
class BaseAgent(ABC):
    @abstractmethod
    def retrieve_with_trace(self, query: str, thread_id: str = "default") -> dict:
        """å­ç±»å®ç°ï¼šè¿”å›ç»“æ„åŒ–æ£€ç´¢è¯æ®ï¼ˆç”¨äºæœåŠ¡ä¾§èšåˆ/ç”Ÿæˆï¼‰"""
        pass
```

### 2. graph/ - å›¾è°±æ„å»º

**æµç¨‹æ¶æ„**ï¼š

```mermaid
graph TB
    A[æ–‡æ¡£è¾“å…¥] --> B[extraction/<br/>å®ä½“å…³ç³»æå–]
    B --> C[processing/<br/>å®ä½“æ¶ˆæ­§å¯¹é½]
    C --> D[core/<br/>Neo4jå­˜å‚¨]
    D --> E[indexing/<br/>å‘é‡ç´¢å¼•æ„å»º]

    B --> B1[LLMé©±åŠ¨æå–<br/>entity_extractor.py]
    B --> B2[å…³ç³»æŠ½å–<br/>relationship_extractor.py]

    C --> C1[å®ä½“æ¶ˆæ­§<br/>entity_disambiguator.py]
    C --> C2[å®ä½“å¯¹é½<br/>entity_aligner.py]

    D --> D1[å›¾è®¿é—®ç«¯å£<br/>ports/neo4jdb.py]
    D --> D2[å›¾ä¸€è‡´æ€§éªŒè¯<br/>graph_validator.py]

    E --> E1[å®ä½“ç´¢å¼•<br/>entity_indexer.py]
    E --> E2[æ–‡æœ¬å—ç´¢å¼•<br/>chunk_indexer.py]

    style C fill:#ff9,stroke:#333
    style E fill:#9f9,stroke:#333
```

**å…³é”®ç»„ä»¶**ï¼š

| ç»„ä»¶ | æ–‡ä»¶è·¯å¾„ | åŠŸèƒ½ |
|------|---------|------|
| **å®ä½“æå–å™¨** | `extraction/entity_extractor.py` | LLMè¯†åˆ«å®ä½“å’Œå±æ€§ |
| **å…³ç³»æå–å™¨** | `extraction/relationship_extractor.py` | LLMè¯†åˆ«å®ä½“é—´å…³ç³» |
| **å®ä½“æ¶ˆæ­§å™¨** | `processing/entity_disambiguator.py` | Mentionâ†’Canonicalæ˜ å°„ |
| **å®ä½“å¯¹é½å™¨** | `processing/entity_aligner.py` | è§£å†³åŒåå®ä½“å†²çª |
| **å›¾è®¿é—®ç«¯å£** | `ports/neo4jdb.py` | GraphClient/GraphQueryPort æ¥å£ |
| **å®ä½“ç´¢å¼•** | `indexing/entity_indexer.py` | å®ä½“å‘é‡ç´¢å¼•æ„å»º |
| **æ–‡æœ¬ç´¢å¼•** | `indexing/chunk_indexer.py` | æ–‡æœ¬å—å‘é‡ç´¢å¼•æ„å»º |

### 3. search/ - æ£€ç´¢å¼•æ“

**ä¸‰çº§æ£€ç´¢ç­–ç•¥**ï¼š

```mermaid
graph TB
    A[ç”¨æˆ·æŸ¥è¯¢] --> B{æ£€ç´¢ç­–ç•¥é€‰æ‹©}

    B --> C[Local Search<br/>local_search.py]
    B --> D[Global Search<br/>global_search.py]
    B --> E[Hybrid Search<br/>tool/hybrid_tool.py]

    C --> C1[å®ä½“è¯†åˆ«]
    C1 --> C2[é‚»åŸŸæ‰©å±•<br/>1-2è·³å…³ç³»]
    C2 --> C3[ç¤¾åŒºä¸Šä¸‹æ–‡]
    C3 --> C4[ç›¸å…³æ–‡æœ¬å—]

    D --> D1[ç¤¾åŒºæ‘˜è¦æ£€ç´¢]
    D1 --> D2[Map-Reduceèšåˆ]
    D2 --> D3[å…¨å±€è§†è§’ç­”æ¡ˆ]

    E --> E1[å‘é‡æ£€ç´¢]
    E --> E2[å›¾è°±æ£€ç´¢]
    E --> E3[ç¤¾åŒºæ£€ç´¢]
    E1 --> E4[ç»“æœèåˆ]
    E2 --> E4
    E3 --> E4

    style C fill:#9f9,stroke:#333
    style D fill:#99f,stroke:#333
    style E fill:#f99,stroke:#333
```

**å·¥å…·é›† tool/**ï¼š

| å·¥å…· | æ–‡ä»¶ | ç”¨é€” |
|------|------|------|
| **NaiveSearchTool** | `naive_search_tool.py` | çº¯å‘é‡æ£€ç´¢ |
| **LocalSearchTool** | `local_search_tool.py` | å®ä½“ä¸­å¿ƒæ£€ç´¢ |
| **GlobalSearchTool** | `global_search_tool.py` | ç¤¾åŒºèšåˆæ£€ç´¢ |
| **HybridTool** | `hybrid_tool.py` | å¤šç­–ç•¥èåˆ |
| **DeepResearchTool** | `deep_research_tool.py` | å¤šæ­¥æ¨ç† |
| **ChainExplorationTool** | `chain_exploration_tool.py` | å›¾è°±æ¢ç´¢é“¾ |

**æ¨ç†ç»„ä»¶ reasoning/**ï¼š
- `chain_of_exploration.py`ï¼šå›¾è°±å¤šè·³æ¨ç†
- `evidence.py`ï¼šè¯æ®è¿½è¸ªä¸ç®¡ç†
- `validator.py`ï¼šç­”æ¡ˆéªŒè¯
- `thinking.py`ï¼šæ€è€ƒæ­¥éª¤ç”Ÿæˆ

### 4. backend/infrastructure/persistence/ - ä¼šè¯ä¸åé¦ˆæŒä¹…åŒ–

> v3 strictï¼šä¸åšâ€œæ£€ç´¢ç»“æœç¼“å­˜/Agent å†…ç¼“å­˜â€ã€‚æŒä¹…åŒ–åªç”¨äºä¼šè¯è®°å½•ã€åé¦ˆç­‰ç³»ç»Ÿæ•°æ®ã€‚

**è½ç‚¹**ï¼š
- ä¼šè¯æ¶ˆæ¯/å¯¹è¯ï¼šPostgresï¼ˆsystem-of-recordï¼‰
- åé¦ˆï¼šPostgresï¼ˆfeedback è¡¨ï¼‰
- é•¿æœŸè®°å¿†ï¼šmem0ï¼ˆæœ¬åœ°/è‡ªæ‰˜ç®¡ï¼Œå­˜å‘é‡åº“ + Postgres å…ƒæ•°æ®ï¼‰

### 5. community/ - ç¤¾åŒºæ£€æµ‹

**åŒç®—æ³•ç­–ç•¥**ï¼š

```mermaid
graph TB
    A[Neo4jå›¾è°±] --> B[GDSå›¾æŠ•å½±]
    B --> C{ç¤¾åŒºæ£€æµ‹ç®—æ³•}

    C --> D[Leidenç®—æ³•<br/>detector/leiden.py]
    C --> E[SLLPAç®—æ³•<br/>detector/sllpa.py]

    D --> F{æ£€æµ‹åˆ°ç¤¾åŒº?}
    E --> F

    F -->|æ˜¯| G[ç¤¾åŒºåˆ†å±‚<br/>0,1,2...]
    F -->|å¦| H[Fallback to Leiden]

    G --> I[ç¤¾åŒºæ‘˜è¦ç”Ÿæˆ<br/>summary/generator.py]
    I --> J[LLMæ‰¹é‡æ‘˜è¦]
    J --> K[å­˜å‚¨åˆ°Neo4j<br/>CommunityèŠ‚ç‚¹]

    style D fill:#9f9,stroke:#333
    style I fill:#ff9,stroke:#333
```

**ç¤¾åŒºæ‘˜è¦ç¤ºä¾‹**ï¼š
```
ç¤¾åŒº0 (1097èŠ‚ç‚¹):
ä¸»é¢˜ï¼šä¼˜ç§€å­¦ç”Ÿè¯„å®šä¸å¥–åŠ±ä½“ç³»
æ‘˜è¦ï¼šæœ¬ç¤¾åŒºåŒ…å«ä¼˜ç§€å­¦ç”Ÿã€ä¼˜ç§€å›¢å‘˜ã€ç¤¾ä¼šå·¥ä½œå¥–ç­‰è¯„å®šæ ‡å‡†å’Œæµç¨‹ã€‚
      æ ¸å¿ƒè§„å®šåŒ…æ‹¬ï¼šå¾·è‚²è€ƒæ ¸æˆç»©ã€å…ˆè¿›ä¸ªäººç§°å·ã€ç­çº§è€ƒæ ¸ç­‰...
```

### 6. pipelines/ingestion/ - æ–‡æ¡£æ‘„å–

**å¤„ç†æµç¨‹**ï¼š

```mermaid
graph LR
    A[files/ç›®å½•] --> B[FileReader<br/>å¤šæ ¼å¼æ”¯æŒ]

    B --> C{æ–‡ä»¶ç±»å‹}
    C -->|TXT/MD| D1[çº¯æ–‡æœ¬è¯»å–]
    C -->|PDF| D2[PyPDF2æå–]
    C -->|DOCX| D3[python-docxè§£æ]
    C -->|DOC| D4[antiwordè½¬æ¢]
    C -->|CSV/JSON/YAML| D5[ç»“æ„åŒ–è§£æ]

    D1 --> E[DocumentProcessor<br/>æ–‡æ¡£å¤„ç†å™¨]
    D2 --> E
    D3 --> E
    D4 --> E
    D5 --> E

    E --> F[TextChunker<br/>æ–‡æœ¬åˆ†å—]

    F --> G{åˆ†å—ç­–ç•¥}
    G -->|HanLP| H1[è¯­ä¹‰åˆ†å—<br/>ä¸­æ–‡ä¼˜åŒ–]
    G -->|Simple| H2[å›ºå®šçª—å£åˆ†å—]

    H1 --> I[Chunks + å…ƒæ•°æ®]
    H2 --> I

    style B fill:#9f9,stroke:#333
    style F fill:#ff9,stroke:#333
```

**æ”¯æŒæ ¼å¼**ï¼š
- æ–‡æœ¬ï¼šTXT, MDï¼ˆMarkdownï¼‰
- æ–‡æ¡£ï¼šPDF, DOCX, DOC
- æ•°æ®ï¼šCSV, JSON, YAML/YML

**åˆ†å—ç­–ç•¥**ï¼š
- **HanLP**ï¼ˆæ¨èï¼‰ï¼šåŸºäºä¸­æ–‡è¯­ä¹‰çš„æ™ºèƒ½åˆ†å—
- **Simple**ï¼šå›ºå®šçª—å£ + é‡å 

### 7. tools/evaluation/ - è¯„ä¼°ç³»ç»Ÿ

> è¯„ä¼°å·¥å…·ç‹¬ç«‹äºæ ¸å¿ƒç®—æ³•ï¼Œä¾¿äºåœ¨æœåŠ¡å¤–éƒ¨è¿è¡Œã€‚

**20+è¯„ä¼°æŒ‡æ ‡**ï¼š

```mermaid
mindmap
  root((è¯„ä¼°ä½“ç³»))
    ç­”æ¡ˆè´¨é‡
      äº‹å®å‡†ç¡®æ€§
      å®Œæ•´æ€§
      ä¸€è‡´æ€§
      å¯è¯»æ€§
    æ£€ç´¢æ€§èƒ½
      ç²¾ç¡®ç‡ Precision
      å¬å›ç‡ Recall
      F1 Score
      NDCG
    å›¾è°±è´¨é‡
      å®ä½“è¦†ç›–ç‡
      å…³ç³»å‡†ç¡®ç‡
      ç¤¾åŒºè´¨é‡
      å›¾è°±å¯†åº¦
    æ·±åº¦ç ”ç©¶
      æ¨ç†æ­¥éª¤åˆç†æ€§
      è¯æ®å……åˆ†æ€§
      æ€è€ƒæ·±åº¦
      å¤šæ ·æ€§
```

**ç›®å½•ç»“æ„**ï¼š
```
tools/evaluation/
â”œâ”€â”€ core/                   # è¯„ä¼°æ ¸å¿ƒ
â”‚   â”œâ”€â”€ evaluator.py        # è¯„ä¼°å™¨åŸºç±»
â”‚   â””â”€â”€ runner.py           # æ‰¹é‡è¯„ä¼°è¿è¡Œå™¨
â”œâ”€â”€ metrics/                # è¯„ä¼°æŒ‡æ ‡
â”‚   â”œâ”€â”€ answer/             # ç­”æ¡ˆè´¨é‡æŒ‡æ ‡
â”‚   â”œâ”€â”€ retrieval/          # æ£€ç´¢æ€§èƒ½æŒ‡æ ‡
â”‚   â”œâ”€â”€ graph/              # å›¾è°±è´¨é‡æŒ‡æ ‡
â”‚   â””â”€â”€ deep_research/      # æ·±åº¦ç ”ç©¶æŒ‡æ ‡
â””â”€â”€ test/                   # æµ‹è¯•è„šæœ¬
    â””â”€â”€ README.md           # è¯„ä¼°ä½¿ç”¨æ–‡æ¡£
```

### 8. é…ç½®ç®¡ç†ï¼ˆbackend/infrastructure/config + backend/config/ragï¼‰

**ä¸‰å±‚é…ç½®ä½“ç³»**ï¼š

```mermaid
graph TB
	    A[.env ç¯å¢ƒå˜é‡] --> D[æœ€ç»ˆé…ç½®]
	    B[backend/config/rag.py è¯­ä¹‰é…ç½®] --> D
	    E[backend/infrastructure/config/settings.py åŸºç¡€è®¾æ–½é…ç½®] --> D
	    C[backend/config/settings.py æœåŠ¡é…ç½®] --> D

	    A --> A1[APIå¯†é’¥<br/>æ•°æ®åº“è¿æ¥<br/>æ€§èƒ½å‚æ•°]
	    B --> B1[å®ä½“ç±»å‹<br/>å…³ç³»ç±»å‹<br/>è¯­ä¹‰é»˜è®¤å€¼]
	    E --> E1[Neo4jé…ç½®<br/>ç¼“å­˜é…ç½®<br/>æ¨¡å‹é…ç½®]
	    C --> C1[HTTP/SSE/Phase2 å¼€å…³]

    style A fill:#f99,stroke:#333
    style B fill:#9f9,stroke:#333
    style C fill:#99f,stroke:#333
```

**å…³é”®é…ç½®æ–‡ä»¶**ï¼š

		| æ–‡ä»¶ | ä½œç”¨åŸŸ | å†…å®¹ |
		|------|--------|------|
		| `.env` | è¿è¡Œæ—¶å‚æ•° | APIå¯†é’¥ã€æ•°æ®åº“URIã€æ€§èƒ½è°ƒä¼˜ |
		| `backend/config/rag.py` | RAG è¯­ä¹‰ | KB_NAMEã€themeã€entity_typesã€relationship_typesã€ç¤ºä¾‹é—®é¢˜ã€å·¥å…·æè¿° |
		| `backend/config/settings.py` | åç«¯æœåŠ¡ | SERVER_*ã€PHASE2_ENABLE_*ã€SSE_HEARTBEAT_S ç­‰è¿è¡Œå‚æ•° |
		| `backend/infrastructure/config/settings.py` | åŸºç¡€è®¾æ–½ | NEO4J_*ã€OPENAI_*ã€CACHE_*ã€KB_AUTO_ROUTE* ç­‰ |
		| `backend/graphrag_agent/config/settings.py` | æ ¸å¿ƒé»˜è®¤å€¼ | ä»…ä¿ç•™ç®—æ³•é»˜è®¤å€¼ä¸ç±»å‹ï¼ˆä¸åšç¯å¢ƒ/è¿æ¥è¯»å–ï¼‰ |
		| `frontend/frontend_config/settings.py` | å‰ç«¯ç•Œé¢ | å‰ç«¯ UI/æ¥å£åœ°å€/å±•ç¤ºå¼€å…³ç­‰ï¼ˆä» `.env` è¯»å–ä¸ºä¸»ï¼‰ |

---

## æŠ€æœ¯æ ˆè¯´æ˜

### æ ¸å¿ƒä¾èµ–

```mermaid
graph TB
    subgraph AIæ¡†æ¶
        A1[LangChain<br/>LLMç¼–æ’]
        A2[LangGraph<br/>å·¥ä½œæµç¼–æ’]
        A3[OpenAI API<br/>LLM+Embedding]
    end

    subgraph å›¾æ•°æ®åº“
        B1[Neo4j<br/>å›¾å­˜å‚¨]
        B2[GDS<br/>å›¾ç®—æ³•]
    end

    subgraph Webæ¡†æ¶
        C1[FastAPI<br/>åç«¯API]
        C2[Streamlit<br/>å‰ç«¯UI]
    end

    subgraph NLPå·¥å…·
        D1[HanLP<br/>ä¸­æ–‡åˆ†è¯]
        D2[Sentence-Transformers<br/>æœ¬åœ°Embedding]
    end

    subgraph æ•°æ®å¤„ç†
        E1[PyPDF2<br/>PDFè§£æ]
        E2[python-docx<br/>Wordè§£æ]
        E3[Pydantic<br/>æ•°æ®éªŒè¯]
    end

    A1 --> A2
    A2 --> C1
    B1 --> B2
    C2 --> C1

    style A2 fill:#9f9,stroke:#333
    style B1 fill:#9f9,stroke:#333
    style C1 fill:#9f9,stroke:#333
```

### å®Œæ•´æŠ€æœ¯æ ˆ

| ç±»åˆ« | æŠ€æœ¯ | ç‰ˆæœ¬è¦æ±‚ | ç”¨é€” |
|------|------|---------|------|
| **Python** | Python | 3.10+ | è¿è¡Œç¯å¢ƒ |
| **LLMæ¡†æ¶** | LangChain | æœ€æ–° | LLMç¼–æ’ |
|  | LangGraph | æœ€æ–° | Agentå·¥ä½œæµ |
| **å›¾æ•°æ®åº“** | Neo4j | 5.x+ | å›¾å­˜å‚¨ |
|  | Neo4j GDS | 2.x+ | å›¾ç®—æ³• |
| **Webæ¡†æ¶** | FastAPI | æœ€æ–° | REST API |
|  | Streamlit | æœ€æ–° | Web UI |
| **NLPå·¥å…·** | HanLP | 2.x | ä¸­æ–‡åˆ†è¯ |
|  | Sentence-Transformers | æœ€æ–° | æœ¬åœ°Embedding |
| **æ–‡æ¡£è§£æ** | PyPDF2 | æœ€æ–° | PDFå¤„ç† |
|  | python-docx | æœ€æ–° | Wordå¤„ç† |
| **æ•°æ®éªŒè¯** | Pydantic | 2.x | SchemaéªŒè¯ |
| **å¹¶å‘** | asyncio | æ ‡å‡†åº“ | å¼‚æ­¥I/O |
|  | ThreadPoolExecutor | æ ‡å‡†åº“ | å¤šçº¿ç¨‹ |

---

## æ¨¡å—èŒè´£ä¸äº¤äº’

### æ•°æ®æµäº¤äº’å›¾

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant F as Frontend
    participant S as Server
    participant A as Agent
    participant SE as Search
    participant G as Graph
    participant N as Neo4j

    U->>F: è¾“å…¥é—®é¢˜
    F->>S: POST /api/v1/chat
    S->>A: ask(query)

    A->>A: é€‰æ‹©å·¥å…·
    A->>SE: è°ƒç”¨æ£€ç´¢å·¥å…·

    alt Local Search
        SE->>G: è¯†åˆ«å®ä½“
        G->>N: CypheræŸ¥è¯¢
        N-->>G: å®ä½“+å…³ç³»
        G-->>SE: é‚»åŸŸä¸Šä¸‹æ–‡
    else Global Search
        SE->>G: æŸ¥è¯¢ç¤¾åŒº
        G->>N: è·å–ç¤¾åŒºæ‘˜è¦
        N-->>G: ç¤¾åŒºæ•°æ®
        G-->>SE: å…¨å±€ä¸Šä¸‹æ–‡
    end

    SE-->>A: æ£€ç´¢ç»“æœ
    A->>A: LLMç”Ÿæˆç­”æ¡ˆ
    A-->>S: ç­”æ¡ˆ+æ¨ç†è½¨è¿¹
    S-->>F: Streamå“åº”
    F-->>U: æ˜¾ç¤ºç­”æ¡ˆ+å¯è§†åŒ–
```

### æ¨¡å—ä¾èµ–å…³ç³»

```mermaid
graph TB
    subgraph è¡¨ç¤ºå±‚
        F[frontend/]
        S[backend/server/]
    end

    subgraph åº”ç”¨å±‚
        APP[backend/application/]
        DOM[backend/domain/]
    end

    subgraph åŸºç¡€è®¾æ–½å±‚
        INF[backend/infrastructure/]
    end

    subgraph æ ¸å¿ƒå±‚
        CORE[backend/graphrag_agent/]
    end

    subgraph å·¥å…·å±‚
        TOOLS[tools/]
    end

    F --> S
    S --> APP
    APP --> DOM
    APP --> INF
    INF --> CORE
    TOOLS --> INF

    style CORE fill:#9f9,stroke:#333
```

---

## éƒ¨ç½²æ¶æ„

### å¼€å‘ç¯å¢ƒ

```mermaid
graph TB
    subgraph å¼€å‘æœºå™¨
        A[Python 3.10ç¯å¢ƒ]
        B[Neo4j Dockerå®¹å™¨]
        C[Streamlitå‰ç«¯<br/>ç«¯å£:8501]
        D[FastAPIåç«¯<br/>ç«¯å£:8000]
    end

    E[OpenAI API<br/>æˆ–One-APIä»£ç†]

    A --> C
    A --> D
    D --> B
    D --> E

    style B fill:#9f9,stroke:#333
```

### ç”Ÿäº§ç¯å¢ƒï¼ˆæ¨èï¼‰

```mermaid
graph TB
    subgraph è´Ÿè½½å‡è¡¡
        LB[Nginx<br/>è´Ÿè½½å‡è¡¡å™¨]
    end

    subgraph Webå±‚
        F1[Streamlitå®ä¾‹1]
        F2[Streamlitå®ä¾‹2]
    end

    subgraph APIå±‚
        S1[FastAPIå®ä¾‹1]
        S2[FastAPIå®ä¾‹2]
        S3[FastAPIå®ä¾‹3]
    end

    subgraph æ•°æ®å±‚
        N1[Neo4jä¸»èŠ‚ç‚¹]
        N2[Neo4jå‰¯æœ¬1]
        N3[Neo4jå‰¯æœ¬2]
        R[Redisç¼“å­˜]
    end

    subgraph å¤–éƒ¨æœåŠ¡
        O[One-APIç½‘å…³]
        M[ç›‘æ§ç³»ç»Ÿ<br/>Prometheus+Grafana]
    end

    LB --> F1
    LB --> F2

    F1 --> S1
    F1 --> S2
    F2 --> S2
    F2 --> S3

    S1 --> N1
    S2 --> N1
    S3 --> N1

    N1 --> N2
    N1 --> N3

    S1 --> R
    S2 --> R
    S3 --> R

    S1 --> O
    S2 --> O
    S3 --> O

    S1 --> M
    S2 --> M
    S3 --> M

    style N1 fill:#9f9,stroke:#333
    style R fill:#ff9,stroke:#333
```

**éƒ¨ç½²å»ºè®®**ï¼š
- **å°è§„æ¨¡**ï¼ˆ<100ç”¨æˆ·ï¼‰ï¼šå•æœºéƒ¨ç½²ï¼ˆ1ä¸ªFastAPI + 1ä¸ªStreamlit + 1ä¸ªNeo4jï¼‰
- **ä¸­è§„æ¨¡**ï¼ˆ100-1000ç”¨æˆ·ï¼‰ï¼šFastAPIå¤šå®ä¾‹ + Neo4jä¸»ä» + Redisç¼“å­˜
- **å¤§è§„æ¨¡**ï¼ˆ>1000ç”¨æˆ·ï¼‰ï¼šå®Œæ•´è´Ÿè½½å‡è¡¡ + Neo4jé›†ç¾¤ + åˆ†å¸ƒå¼ç¼“å­˜

---

## ç›¸å…³æ–‡æ¡£

### å†…éƒ¨æ–‡æ¡£
- [æ•°æ®æµæ€»è§ˆ](./æ•°æ®æµæ€»è§ˆ.md) - å®Œæ•´æ•°æ®å¤„ç†æµç¨‹
- [æœ¬é¡¹ç›®çš„åˆ›æ–°ç‚¹](../../01-ç†è®ºåŸºç¡€/æœ¬é¡¹ç›®çš„åˆ›æ–°ç‚¹.md) - æŠ€æœ¯åˆ›æ–°è¯´æ˜
- [ç¬¬ä¸€æ¬¡å¯¹è¯](../../00-å¿«é€Ÿå¼€å§‹/ç¬¬ä¸€æ¬¡å¯¹è¯.md) - å¿«é€Ÿå¼€å§‹æŒ‡å—
- [Agentç³»ç»Ÿ](../02-æ ¸å¿ƒå­ç³»ç»Ÿ/Agentç³»ç»Ÿ.md) - å¤šæ™ºèƒ½ä½“è¯¦ç»†è®¾è®¡

### æ¨¡å—æ–‡æ¡£
æ¯ä¸ªå­æ¨¡å—éƒ½æœ‰ç‹¬ç«‹çš„READMEï¼š
- `backend/graphrag_agent/agents/README.md` - Agentç³»ç»Ÿ
- `backend/graphrag_agent/graph/README.md` - å›¾è°±æ„å»º
- `backend/graphrag_agent/search/README.md` - æ£€ç´¢å¼•æ“
- `backend/infrastructure/persistence/README.md` - ä¼šè¯ä¸åé¦ˆæŒä¹…åŒ–
- `backend/graphrag_agent/community/README.md` - ç¤¾åŒºæ£€æµ‹
- `tools/evaluation/README.md` - è¯„ä¼°ç³»ç»Ÿ

### å¤–éƒ¨å‚è€ƒ
- [Neo4jå®˜æ–¹æ–‡æ¡£](https://neo4j.com/docs/)
- [LangGraphå®˜æ–¹æ–‡æ¡£](https://langchain-ai.github.io/langgraph/)
- [FastAPIå®˜æ–¹æ–‡æ¡£](https://fastapi.tiangolo.com/)
- [Streamlitå®˜æ–¹æ–‡æ¡£](https://docs.streamlit.io/)

---

## æ›´æ–°æ—¥å¿—

| æ—¥æœŸ | ç‰ˆæœ¬ | æ›´æ–°å†…å®¹ |
|------|------|----------|
| 2026-01-04 | v1.0 | åˆå§‹ç‰ˆæœ¬ï¼Œå®Œæ•´æ¶æ„è¯´æ˜ |

---

**è´¡çŒ®è€…**ï¼šé¡¹ç›®å›¢é˜Ÿ
**ç»´æŠ¤è€…**ï¼šæ¶æ„å§”å‘˜ä¼š
**åé¦ˆæ¸ é“**ï¼šGitHub Issuesa
