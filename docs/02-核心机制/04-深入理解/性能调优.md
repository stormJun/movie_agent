# 性能调优（v3 strict）

本文件聚焦 v3 strict 的性能调优入口（并发、批处理、超时、流式事件节奏）。历史版本的调优文档已归档到：

- `docs/99-参考资料/历史文档/深入理解/性能调优_旧版含缓存.md`

## 1. 并发与批处理

常用环境变量（参考 `.env.example`）：

- `MAX_WORKERS`：线程池并发度（检索/构建等 CPU/IO 混合任务）
- `ENTITY_BATCH_SIZE` / `CHUNK_BATCH_SIZE` / `EMBEDDING_BATCH_SIZE`：构建阶段批处理

## 2. 超时与降级

- RAG 生成超时：`RAG_ANSWER_TIMEOUT_S`
- 流式阶段的 keepalive：`SSE_HEARTBEAT_S`

## 3. 可观测性

- debug/trace 字段用于定位路由决策、检索计划与证据聚合过程

