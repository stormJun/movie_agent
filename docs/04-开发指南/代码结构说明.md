# 代码结构说明

> 目标：帮助开发者快速定位“代码在哪、入口在哪、配置在哪”。

## 项目目录概览

> 约束：后端代码只允许存在于 `backend/` 下；仓库根目录不要再出现 `server/`、`application/`、`domain/`、`infrastructure/`、`graphrag_agent/` 等后端包目录。

```
graph-rag-agent/
├── backend/graphrag_agent/                # 核心运行时（Agent / Graph / Search / Ports）
├── backend/infrastructure/                # 基础设施（集成/管道/缓存/模型/路由）
├── backend/server/                        # FastAPI 后端
├── frontend/                      # Streamlit 前端（通用工作台）
├── data/                          # 数据处理脚本与样例（如 data/movie）
├── docs/                          # 项目文档
├── files/                         # 运行时输入与产物（默认被 .gitignore 忽略）
├── cache/                         # 运行时缓存（默认被 .gitignore 忽略）
└── docker-compose.yaml            # Neo4j 本地启动
```

## 核心模块定位

- Agent 入口：`backend/graphrag_agent/agents/`
- 构建入口（全量/增量）：`backend/infrastructure/integrations/build/`
- 图数据库连接：`backend/infrastructure/config/neo4jdb.py`
- 配置：`.env.example`（运行时覆盖） + `backend/infrastructure/config/settings.py`（基础设施默认值） + `backend/config/rag.py`（领域/RAG 语义默认值）
- FastAPI：`backend/server/main.py`、`backend/server/api/rest/v1/`
- Streamlit：`frontend/app.py`

## 常用运行命令

```bash
# 启动 Neo4j（本地）
docker compose up -d

# 启动 FastAPI
bash scripts/dev.sh backend

# 启动 Streamlit（如果需要）
streamlit run frontend/app.py

# 如果在脚本/REPL 中直接使用 graphrag_agent，请先注入基础设施 Provider
# （backend/server 入口已自动 bootstrap）
# 参考：from infrastructure.bootstrap import bootstrap_core_ports; bootstrap_core_ports()

# 全量构建（读 files/，写 Neo4j / 向量索引）
bash scripts/py.sh infrastructure.integrations.build.main

# 运行单元测试
bash scripts/test.sh
```

## 相关文档

- 开发指南首页：`docs/04-开发指南/README.md`
- 快速开始：`docs/00-快速开始/README.md`
