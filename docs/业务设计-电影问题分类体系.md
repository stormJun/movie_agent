# ç”µå½±ä¸šåŠ¡é—®é¢˜åˆ†ç±»ä½“ç³»

## ç›®æ ‡
ä¸ºç”µå½±é—®ç­”/æ¨èç³»ç»Ÿå»ºç«‹é—®é¢˜åˆ†ç±»æ ‡å‡†ï¼Œæ˜ç¡®ï¼š
1. **é—®é¢˜ç±»å‹**ï¼šè¯†åˆ«ç”¨æˆ·æ„å›¾
2. **è¯æ®éœ€æ±‚**ï¼šéœ€è¦æ£€ç´¢ä»€ä¹ˆæ•°æ®
3. **è¾“å‡ºç»“æ„**ï¼šè¿”å›ä»€ä¹ˆæ ¼å¼
4. **Agenté€‰æ‹©**ï¼šç”¨å“ªä¸ªAgentå¤„ç†

---

## ä¸€ã€é—®é¢˜åˆ†ç±»å…¨æ™¯å›¾

```
ç”µå½±ä¸šåŠ¡é—®é¢˜
â”‚
â”œâ”€ 1ï¸âƒ£ äº‹å®æŸ¥è¯¢ç±» (Fact Query)
â”‚   â”œâ”€ 1.1 å®ä½“æŸ¥è¯¢
â”‚   â”œâ”€ 1.2 åˆ—ä¸¾æŸ¥è¯¢
â”‚   â””â”€ 1.3 æ•°æ®æŸ¥è¯¢
â”‚
â”œâ”€ 2ï¸âƒ£ æ¨èå‘ç°ç±» (Recommendation)
â”‚   â”œâ”€ 2.1 å¼€æ”¾æ¨è
â”‚   â”œâ”€ 2.2 çº¦æŸæ¨è
â”‚   â””â”€ 2.3 åœºæ™¯æ¨è
â”‚
â”œâ”€ 3ï¸âƒ£ ç›¸ä¼¼æ¨èç±» (Similarity)
â”‚   â”œâ”€ 3.1 ç”µå½±ç›¸ä¼¼
â”‚   â””â”€ 3.2 è·¨æ¨¡æ€ç›¸ä¼¼
â”‚
â”œâ”€ 4ï¸âƒ£ å†…å®¹è§£æç±» (Analysis)
â”‚   â”œâ”€ 4.1 å‰§æƒ…è§£æ
â”‚   â”œâ”€ 4.2 ä¸»é¢˜åˆ†æ
â”‚   â””â”€ 4.3 å½©è›‹å½©è›‹
â”‚
â”œâ”€ 5ï¸âƒ£ å¯¹æ¯”åˆ†æç±» (Comparison)
â”‚   â”œâ”€ 5.1 ä¸¤éƒ¨ç”µå½±å¯¹æ¯”
â”‚   â””â”€ 5.2 å¤šç»´åº¦å¯¹æ¯”
â”‚
â””â”€ 6ï¸âƒ£ å…³è”æ¨ç†ç±» (Reasoning)
    â”œâ”€ 6.1 å›¾è°±æ¨ç†
    â””â”€ 6.2 å› æœæ¨ç†
```

---

## äºŒã€è¯¦ç»†åˆ†ç±»æ ‡å‡†

### ç±»å‹ 1ï¸âƒ£ï¼šäº‹å®æŸ¥è¯¢ç±» (Fact Query)

**ç”¨æˆ·æ„å›¾**ï¼šè·å–å®¢è§‚äº‹å®ä¿¡æ¯

---

#### 1.1 å®ä½“æŸ¥è¯¢ (Entity Query)

**é—®é¢˜ç¤ºä¾‹**ï¼š
- "è¯ºå…°æ˜¯è°ï¼Ÿ"
- "ã€Šæ˜Ÿé™…ç©¿è¶Šã€‹çš„ä¸»æ¼”æ˜¯è°ï¼Ÿ"
- "æ¼«å¨ç”µå½±å®‡å®™æ˜¯ä»€ä¹ˆï¼Ÿ"

**è¯æ®éœ€æ±‚**ï¼š
```python
{
    "entities": [
        {
            "name": "å…‹é‡Œæ–¯æ‰˜å¼—Â·è¯ºå…°",
            "type": "Director",
            "attributes": {
                "birth_date": "1970-07-30",
                "nationality": "è‹±å›½",
                "works": ["ç›—æ¢¦ç©ºé—´", "æ˜Ÿé™…ç©¿è¶Š", "é»‘æš—éª‘å£«"]
            }
        }
    ],
    "relationships": [
        {
            "from": "è¯ºå…°",
            "to": "æ˜Ÿé™…ç©¿è¶Š",
            "type": "å¯¼æ¼”"
        }
    ]
}
```

**è¾“å‡ºç»“æ„**ï¼š
```json
{
    "type": "entity_profile",
    "entity": {
        "name": "å…‹é‡Œæ–¯æ‰˜å¼—Â·è¯ºå…°",
        "chinese_name": "å…‹é‡Œæ–¯æ‰˜å¼—Â·è¯ºå…°",
        "type": "Director"
    },
    "basic_info": {
        "birth_date": "1970-07-30",
        "nationality": "è‹±å›½",
        "occupation": "å¯¼æ¼”ã€ç¼–å‰§ã€åˆ¶ä½œäºº"
    },
    "works": [
        {
            "title": "ç›—æ¢¦ç©ºé—´",
            "year": 2010,
            "rating": 8.8
        },
        {
            "title": "æ˜Ÿé™…ç©¿è¶Š",
            "year": 2014,
            "rating": 8.6
        }
    ],
    "style_tags": ["éçº¿æ€§å™äº‹", "çƒ§è„‘", "ç§‘å¹»"],
    "answer": "å…‹é‡Œæ–¯æ‰˜å¼—Â·è¯ºå…°æ˜¯è‹±å›½è‘—åå¯¼æ¼”ï¼Œä»¥å¤æ‚çš„å™äº‹ç»“æ„å’Œç§‘å¹»é¢˜æé—»å..."
}
```

**Agenté€‰æ‹©**ï¼š`GraphAgent` æˆ– `HybridAgent`
**æ£€ç´¢ç­–ç•¥**ï¼šå®ä½“ä¸­å¿ƒæ£€ç´¢ + 1è·³å…³ç³»

---

#### 1.2 åˆ—ä¸¾æŸ¥è¯¢ (List Query)

**é—®é¢˜ç¤ºä¾‹**ï¼š
- "è¯ºå…°å¯¼æ¼”è¿‡å“ªäº›ç§‘å¹»ç”µå½±ï¼Ÿ"
- "æ¼«å¨ç¬¬ä¸€é˜¶æ®µæœ‰å“ªäº›ç”µå½±ï¼Ÿ"
- "2023å¹´è¯„åˆ†æœ€é«˜çš„10éƒ¨ç”µå½±"

**è¯æ®éœ€æ±‚**ï¼š
```python
{
    "query_pattern": {
        "subject": "è¯ºå…°",
        "constraint": ["ç±»å‹=ç§‘å¹»", "æ’åº=è¯„åˆ†é™åº"],
        "limit": 10
    },
    "entities": [
        {"name": "æ˜Ÿé™…ç©¿è¶Š", "year": 2014, "rating": 8.6},
        {"name": "ç›—æ¢¦ç©ºé—´", "year": 2010, "rating": 8.8},
        {"name": "ä¿¡æ¡", "year": 2020, "rating": 7.6}
    ]
}
```

**è¾“å‡ºç»“æ„**ï¼š
```json
{
    "type": "movie_list",
    "query_understanding": {
        "director": "å…‹é‡Œæ–¯æ‰˜å¼—Â·è¯ºå…°",
        "genres": ["ç§‘å¹»"],
        "sort_by": "rating",
        "limit": null
    },
    "results": [
        {
            "rank": 1,
            "movie": {
                "title": "ç›—æ¢¦ç©ºé—´",
                "year": 2010,
                "rating": 8.8,
                "genres": ["ç§‘å¹»", "åŠ¨ä½œ", "æ‚¬ç–‘"]
            },
            "reason": "è¯ºå…°å¯¼æ¼”çš„ç§‘å¹»ç”µå½±ï¼Œè¯„åˆ†8.8"
        },
        {
            "rank": 2,
            "movie": {
                "title": "æ˜Ÿé™…ç©¿è¶Š",
                "year": 2014,
                "rating": 8.6,
                "genres": ["ç§‘å¹»", "å†’é™©", "å‰§æƒ…"]
            },
            "reason": "è¯ºå…°å¯¼æ¼”çš„ç§‘å¹»ç”µå½±ï¼Œè¯„åˆ†8.6"
        }
    ],
    "total_count": 5,
    "answer": "è¯ºå…°å¯¼æ¼”è¿‡5éƒ¨ç§‘å¹»ç”µå½±ï¼ŒæŒ‰è¯„åˆ†æ’åºï¼š..."
}
```

**Agenté€‰æ‹©**ï¼š`PrecisionSearchAgent`
**æ£€ç´¢ç­–ç•¥**ï¼šç»“æ„åŒ–æŸ¥è¯¢ + è¿‡æ»¤å™¨ + æ’åº

---

#### 1.3 æ•°æ®æŸ¥è¯¢ (Data Query)

**é—®é¢˜ç¤ºä¾‹**ï¼š
- "ã€Šå¤ä»‡è€…è”ç›Ÿ4ã€‹çš„ç¥¨æˆ¿æ˜¯å¤šå°‘ï¼Ÿ"
- "å¥¥æ–¯å¡æœ€ä½³å½±ç‰‡2020å¹´æ˜¯è°ï¼Ÿ"
- "ã€Šè‚–ç”³å…‹çš„æ•‘èµã€‹åœ¨IMDbæ’åå¤šå°‘ï¼Ÿ"

**è¯æ®éœ€æ±‚**ï¼š
```python
{
    "entities": [{"name": "å¤ä»‡è€…è”ç›Ÿ4"}],
    "attributes": {
        "box_office": "27.98äº¿ç¾å…ƒ",
        "release_date": "2019-04-24"
    }
}
```

**è¾“å‡ºç»“æ„**ï¼š
```json
{
    "type": "fact_data",
    "query": "ã€Šå¤ä»‡è€…è”ç›Ÿ4ã€‹çš„ç¥¨æˆ¿æ˜¯å¤šå°‘ï¼Ÿ",
    "fact": {
        "movie": "å¤ä»‡è€…è”ç›Ÿ4ï¼šç»ˆå±€ä¹‹æˆ˜",
        "box_office": {
            "value": "27.98äº¿ç¾å…ƒ",
            "rank": "å½±å²ç¬¬äºŒ"
        },
        "release_date": "2019-04-24"
    },
    "answer": "ã€Šå¤ä»‡è€…è”ç›Ÿ4ï¼šç»ˆå±€ä¹‹æˆ˜ã€‹å…¨çƒç¥¨æˆ¿è¾¾åˆ°27.98äº¿ç¾å…ƒï¼Œä½å±…å½±å²ç¬¬äºŒ...",
    "sources": [
        {"type": "tmdb", "url": "..."}
    ]
}
```

**Agenté€‰æ‹©**ï¼š`GraphAgent` + TMDBå®æ—¶æŸ¥è¯¢
**æ£€ç´¢ç­–ç•¥**ï¼šå®ä½“å±æ€§æŸ¥è¯¢

---

### ç±»å‹ 2ï¸âƒ£ï¼šæ¨èå‘ç°ç±» (Recommendation)

**ç”¨æˆ·æ„å›¾**ï¼šä¸çŸ¥é“çœ‹ä»€ä¹ˆï¼Œéœ€è¦æ¨è

---

#### 2.1 å¼€æ”¾æ¨è (Open Recommendation)

**é—®é¢˜ç¤ºä¾‹**ï¼š
- "ç»™æˆ‘æ¨èå‡ éƒ¨ç”µå½±"
- "ä»Šæ™šçœ‹ä»€ä¹ˆï¼Ÿ"
- [ç›´æ¥è®¿é—®é¦–é¡µ]

**è¯æ®éœ€æ±‚**ï¼š
```python
{
    "user_profile": {
        "favorite_genres": ["ç§‘å¹»", "æ‚¬ç–‘"],
        "favorite_directors": ["è¯ºå…°"],
        "recently_watched": ["æ˜Ÿé™…ç©¿è¶Š", "é»‘æš—éª‘å£«"],
        "ratings": {"è‚–ç”³å…‹çš„æ•‘èµ": 5, "é˜¿ç”˜æ­£ä¼ ": 5}
    },
    "recommendation_strategy": [
        "collaborative_filtering",  # ååŒè¿‡æ»¤
        "content_based",            # å†…å®¹è¿‡æ»¤
        "exploration"               # æ¢ç´¢æ–°ç±»å‹
    ]
}
```

**è¾“å‡ºç»“æ„**ï¼š
```json
{
    "type": "personalized_recommendation",
    "user_context": {
        "has_profile": true,
        "recent_interests": ["ç§‘å¹»", "æ‚¬ç–‘"]
    },
    "recommendations": [
        {
            "rank": 1,
            "movie": {
                "title": "ç›—æ¢¦ç©ºé—´",
                "year": 2010,
                "rating": 8.8
            },
            "reason": {
                "type": "content_based",
                "explanation": "å› ä¸ºä½ å–œæ¬¢è¯ºå…°å¯¼æ¼”çš„ã€Šæ˜Ÿé™…ç©¿è¶Šã€‹å’Œã€Šé»‘æš—éª‘å£«ã€‹",
                "match_factors": ["åŒå¯¼æ¼”", "åŒç±»å‹"]
            },
            "confidence": 0.92
        },
        {
            "rank": 2,
            "movie": {
                "title": "é»‘å®¢å¸å›½",
                "year": 1999,
                "rating": 8.7
            },
            "reason": {
                "type": "collaborative_filtering",
                "explanation": "å–œæ¬¢ã€Šæ˜Ÿé™…ç©¿è¶Šã€‹çš„ç”¨æˆ·ä¹Ÿå–œæ¬¢è¿™éƒ¨ç”µå½±",
                "similar_users": 1234
            },
            "confidence": 0.85
        },
        {
            "rank": 3,
            "movie": {
                "title": "é™ä¸´",
                "year": 2016,
                "rating": 7.9
            },
            "reason": {
                "type": "exploration",
                "explanation": "å°è¯•ä¸åŒé£æ ¼çš„ç§‘å¹»ç”µå½±",
                "novelty": "é«˜"
            },
            "confidence": 0.65
        }
    ],
    "strategy_used": ["content_based", "collaborative_filtering", "exploration"],
    "answer": "æ ¹æ®ä½ çš„è§‚å½±åå¥½ï¼Œä¸ºä½ æ¨èä»¥ä¸‹ç”µå½±..."
}
```

**Agenté€‰æ‹©**ï¼š`PersonalizedRecAgent`
**æ£€ç´¢ç­–ç•¥**ï¼šç”¨æˆ·ç”»åƒ + å¤šç­–ç•¥æ¨èç®—æ³•

---

#### 2.2 çº¦æŸæ¨è (Constrained Recommendation)

**é—®é¢˜ç¤ºä¾‹**ï¼š
- "æ¨èä¸€äº›è¯„åˆ†8.0ä»¥ä¸Šçš„ç§‘å¹»ç‰‡"
- "æœ‰æ²¡æœ‰é€‚åˆå®¶åº­è§‚çœ‹çš„åŠ¨ç”»ç”µå½±ï¼Ÿ"
- "2020å¹´åå€¼å¾—çœ‹çš„æ‚¬ç–‘ç”µå½±"

**è¯æ®éœ€æ±‚**ï¼š
```python
{
    "constraints": {
        "min_rating": 8.0,
        "genres": ["ç§‘å¹»"],
        "year_range": [2020, 2024],
        "family_friendly": true
    },
    "user_context": {
        "watch_history": ["æ˜Ÿé™…ç©¿è¶Š"],
        "excluded": ["å·²ç»çœ‹è¿‡çš„"]
    }
}
```

**è¾“å‡ºç»“æ„**ï¼š
```json
{
    "type": "constrained_recommendation",
    "constraints": {
        "min_rating": 8.0,
        "genres": ["ç§‘å¹»"],
        "years": [2020, 2021, 2022, 2023, 2024]
    },
    "recommendations": [
        {
            "movie": {
                "title": "æ²™ä¸˜",
                "year": 2021,
                "rating": 8.3
            },
            "match_score": 0.95,
            "reason": "ç¬¦åˆæ‰€æœ‰çº¦æŸæ¡ä»¶ï¼šç§‘å¹»ã€2021å¹´ã€è¯„åˆ†8.3"
        },
        {
            "movie": {
                "title": "é“¶ç¿¼æ€æ‰‹2049",
                "year": 2017,
                "rating": 8.0
            },
            "match_score": 0.88,
            "reason": "ç§‘å¹»ç”µå½±ï¼Œè¯„åˆ†åˆšå¥½8.0"
        }
    ],
    "total_matching": 15,
    "answer": "ç¬¦åˆæ¡ä»¶çš„ç§‘å¹»ç”µå½±æœ‰15éƒ¨ï¼Œæ¨èå‰5éƒ¨ï¼š..."
}
```

**Agenté€‰æ‹©**ï¼š`ExploratorySearchAgent`
**æ£€ç´¢ç­–ç•¥**ï¼šè¿‡æ»¤å™¨ + ç”¨æˆ·ç”»åƒ

---

#### 2.3 åœºæ™¯æ¨è (Scenario-based)

**é—®é¢˜ç¤ºä¾‹**ï¼š
- "é€‚åˆå‘¨æœ«æ”¾æ¾çš„å–œå‰§ç”µå½±"
- "æƒ…ä¾£çº¦ä¼šçœ‹ä»€ä¹ˆç”µå½±å¥½ï¼Ÿ"
- "æ²»æ„ˆç³»ç”µå½±æ¨è"

**è¯æ®éœ€æ±‚**ï¼š
```python
{
    "scenario": {
        "type": "relax",        # æ”¾æ¾
        "mood": "happy",        # å¿«ä¹
        "time": "weekend",      # å‘¨æœ«
        "duration": "< 120min"  # ä¸æƒ³çœ‹å¤ªé•¿çš„
    },
    "scenario_mapping": {
        "relax": ["å–œå‰§", "åŠ¨ç”»"],
        "weekend": ["è½»æ¾", "æ¸©é¦¨"],
        "duration": ["90-120min"]
    }
}
```

**è¾“å‡ºç»“æ„**ï¼š
```json
{
    "type": "scenario_recommendation",
    "scenario": {
        "identified": "å‘¨æœ«æ”¾æ¾",
        "mood": "è½»æ¾æ„‰å¿«",
        "preferences": {
            "genres": ["å–œå‰§", "åŠ¨ç”»"],
            "max_duration": 120,
            "min_rating": 7.0
        }
    },
    "recommendations": [
        {
            "movie": {
                "title": "å¯»æ¢¦ç¯æ¸¸è®°",
                "year": 2017,
                "rating": 9.1,
                "duration": 105,
                "genres": ["åŠ¨ç”»", "å¥‡å¹»", "éŸ³ä¹"]
            },
            "scenario_match": {
                "mood": "æ¸©é¦¨æ²»æ„ˆ",
                "family_friendly": true,
                "weekend_suitable": true
            },
            "reason": "å‘¨æœ«æ”¾æ¾çš„ç»ä½³é€‰æ‹©ï¼Œæ¸©é¦¨æ²»æ„ˆï¼Œé€‚åˆå…¨å®¶è§‚çœ‹"
        }
    ],
    "answer": "é€‚åˆå‘¨æœ«æ”¾æ¾çš„å–œå‰§ç”µå½±æ¨è..."
}
```

**Agenté€‰æ‹©**ï¼š`ExploratorySearchAgent`
**æ£€ç´¢ç­–ç•¥**ï¼šåœºæ™¯æ„å›¾è¯†åˆ« + è§„åˆ™æ˜ å°„

---

### ç±»å‹ 3ï¸âƒ£ï¼šç›¸ä¼¼æ¨èç±» (Similarity)

**ç”¨æˆ·æ„å›¾**ï¼šåŸºäºæŸéƒ¨ç”µå½±æ‰¾ç›¸ä¼¼çš„

---

#### 3.1 ç”µå½±ç›¸ä¼¼ (Movie Similarity)

**é—®é¢˜ç¤ºä¾‹**ï¼š
- "å’Œã€Šè‚–ç”³å…‹çš„æ•‘èµã€‹ç±»ä¼¼çš„ç”µå½±"
- "æœ‰æ²¡æœ‰åƒã€Šé»‘æš—éª‘å£«ã€‹é£æ ¼çš„ï¼Ÿ"
- "å–œæ¬¢ã€Šæ˜Ÿé™…ç©¿è¶Šã€‹ï¼Œæ±‚æ¨è"

**è¯æ®éœ€æ±‚**ï¼š
```python
{
    "source_movie": {
        "title": "è‚–ç”³å…‹çš„æ•‘èµ",
        "attributes": {
            "genres": ["å‰§æƒ…", "çŠ¯ç½ª"],
            "themes": ["å¸Œæœ›", "æ•‘èµ", "å‹è°Š"],
            "director": "å¼—å…°å…‹Â·å¾·æ‹‰é‚¦ç‰¹",
            "rating": 9.7
        }
    },
    "similarity_dimensions": {
        "genre_similarity": 0.8,
        "theme_similarity": 0.9,
        "director_similarity": 0.0,
        "embedding_similarity": 0.85,
        "kg_path_similarity": 0.7
    }
}
```

**è¾“å‡ºç»“æ„**ï¼š
```json
{
    "type": "similarity_recommendation",
    "source_movie": {
        "title": "è‚–ç”³å…‹çš„æ•‘èµ",
        "year": 1994,
        "rating": 9.7
    },
    "similar_movies": [
        {
            "rank": 1,
            "movie": {
                "title": "é˜¿ç”˜æ­£ä¼ ",
                "year": 1994,
                "rating": 9.5
            },
            "similarity_score": 0.92,
            "similarity_breakdown": {
                "genre": 0.85,      # åŒç±»å‹ï¼šå‰§æƒ…
                "theme": 0.95,      # åŒä¸»é¢˜ï¼šå¸Œæœ›ã€äººç”Ÿ
                "era": 0.90,        # åŒæ—¶ä»£ï¼š90å¹´ä»£ç»å…¸
                "quality": 0.95     # åŒçº§åˆ«ï¼šé«˜åˆ†ç»å…¸
            },
            "reason": "åŒæ ·æ˜¯90å¹´ä»£çš„ç»å…¸å‰§æƒ…ç‰‡ï¼Œè®²è¿°å°äººç‰©çš„åŠ±å¿—æ•…äº‹",
            "kg_paths": [
                "è‚–ç”³å…‹çš„æ•‘èµ â†’ [ç±»å‹:å‰§æƒ…] â†’ é˜¿ç”˜æ­£ä¼ ",
                "è‚–ç”³å…‹çš„æ•‘èµ â†’ [ä¸»é¢˜:å¸Œæœ›] â†’ é˜¿ç”˜æ­£ä¼ "
            ]
        },
        {
            "rank": 2,
            "movie": {
                "title": "ç»¿é‡Œå¥‡è¿¹",
                "year": 1999,
                "rating": 8.6
            },
            "similarity_score": 0.88,
            "similarity_breakdown": {
                "genre": 0.90,
                "theme": 0.92,
                "director": 0.95,    # åŒå¯¼æ¼”
                "source": 0.85       # åŒæ”¹ç¼–è‡ªå²è’‚èŠ¬Â·é‡‘å°è¯´
            },
            "reason": "åŒå¯¼æ¼”ä½œå“ï¼ŒåŒæ ·æ”¹ç¼–è‡ªå²è’‚èŠ¬Â·é‡‘å°è¯´ï¼Œä¸»é¢˜ç›¸ä¼¼",
            "kg_paths": [
                "è‚–ç”³å…‹çš„æ•‘èµ â†’ [å¯¼æ¼”:å¼—å…°å…‹Â·å¾·æ‹‰é‚¦ç‰¹] â†’ ç»¿é‡Œå¥‡è¿¹",
                "è‚–ç”³å…‹çš„æ•‘èµ â†’ [æ”¹ç¼–è‡ª:å²è’‚èŠ¬Â·é‡‘] â†’ ç»¿é‡Œå¥‡è¿¹"
            ]
        }
    ],
    "answer": "ä¸ã€Šè‚–ç”³å…‹çš„æ•‘èµã€‹ç›¸ä¼¼çš„ç”µå½±æ¨è..."
}
```

**Agenté€‰æ‹©**ï¼š`SimilarityRecAgent`
**æ£€ç´¢ç­–ç•¥**ï¼šå¤šç»´åº¦ç›¸ä¼¼åº¦ + çŸ¥è¯†å›¾è°±è·¯å¾„

---

#### 3.2 è·¨æ¨¡æ€ç›¸ä¼¼ (Cross-modal Similarity)

**é—®é¢˜ç¤ºä¾‹**ï¼š
- "æœ‰æ²¡æœ‰åƒã€Šä¸‰ä½“ã€‹å°è¯´æ”¹ç¼–çš„ç”µå½±ï¼Ÿ"
- "ã€Šé»‘å®¢å¸å›½ã€‹æ¸¸æˆå’Œç”µå½±å“ªä¸ªå¥½ï¼Ÿ"
- "å’Œã€Šå¤ä»‡è€…è”ç›Ÿã€‹æ¼«ç”»ç±»ä¼¼çš„"

**è¯æ®éœ€æ±‚**ï¼š
```python
{
    "source": {
        "type": "novel",
        "title": "ä¸‰ä½“",
        "attributes": {"themes": ["ç§‘å¹»", "å®‡å®™", "æ–‡æ˜"]}
    },
    "target_type": "movie",
    "cross_modal_mapping": {
        "theme_similarity": 0.8,
        "adaptation_similarity": 0.9
    }
}
```

**è¾“å‡ºç»“æ„**ï¼š
```json
{
    "type": "cross_modal_similarity",
    "source": {
        "type": "novel",
        "title": "ä¸‰ä½“",
        "author": "åˆ˜æ…ˆæ¬£"
    },
    "recommendations": [
        {
            "movie": {
                "title": "æµæµªåœ°çƒ",
                "year": 2019,
                "rating": 7.9
            },
            "relationship": "åŒæ ·æ”¹ç¼–è‡ªåˆ˜æ…ˆæ¬£å°è¯´ï¼Œç¡¬æ ¸ç§‘å¹»",
            "similarity_reasons": [
                "åŒä½œè€…ï¼šåˆ˜æ…ˆæ¬£",
                "åŒç±»å‹ï¼šç¡¬ç§‘å¹»",
                "å…±åŒä¸»é¢˜ï¼šäººç±»å‘½è¿ã€å®‡å®™æ¢ç´¢"
            ]
        }
    ]
}
```

**Agenté€‰æ‹©**ï¼š`SimilarityRecAgent`
**æ£€ç´¢ç­–ç•¥**ï¼šè·¨æ¨¡æ€å…³ç³»æ˜ å°„

---

### ç±»å‹ 4ï¸âƒ£ï¼šå†…å®¹è§£æç±» (Analysis)

**ç”¨æˆ·æ„å›¾**ï¼šç†è§£ç”µå½±çš„æ·±å±‚å†…å®¹

---

#### 4.1 å‰§æƒ…è§£æ (Plot Analysis)

**é—®é¢˜ç¤ºä¾‹**ï¼š
- "ã€Šç›—æ¢¦ç©ºé—´ã€‹çš„ç»“å±€æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ"
- "ã€Šé»‘å®¢å¸å›½ã€‹æ˜¯ç°å®è¿˜æ˜¯è™šæ‹Ÿï¼Ÿ"
- "ã€Šç©†èµ«å…°é“ã€‹åˆ°åº•è®²äº†ä»€ä¹ˆï¼Ÿ"

**è¯æ®éœ€æ±‚**ï¼š
```python
{
    "movie": "ç›—æ¢¦ç©ºé—´",
    "plot_elements": {
        "ending": "é™€èºæ˜¯å¦åœä¸‹",
        "themes": ["æ¢¦å¢ƒ", "ç°å®", "æ½œæ„è¯†"],
        "symbolism": ["é™€èº", "è¿·å®«"]
    },
    "analysis_sources": [
        {"type": "reviews", "content": "å½±è¯„è§£æ"},
        {"type": "director_interview", "content": "è¯ºå…°è®¿è°ˆ"},
        {"type": "community_discussions", "content": "è§‚ä¼—è®¨è®º"}
    ]
}
```

**è¾“å‡ºç»“æ„**ï¼š
```json
{
    "type": "plot_analysis",
    "movie": {
        "title": "ç›—æ¢¦ç©ºé—´",
        "year": 2010
    },
    "question": "ã€Šç›—æ¢¦ç©ºé—´ã€‹çš„ç»“å±€æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ",
    "analysis": {
        "main_explanation": {
            "theory": "å¼€æ”¾å¼ç»“å±€",
            "evidence": [
                "é™€èºæ—‹è½¬é€Ÿåº¦æ²¡æœ‰æ˜æ˜¾å‡é€Ÿ",
                "è¯ºå…°æ¥å—é‡‡è®¿æ—¶è¡¨ç¤ºç­”æ¡ˆä¸é‡è¦"
            ]
        },
        "alternative_theories": [
            {
                "theory": " Cobbä»åœ¨æ¢¦ä¸­",
                "reasoning": "å­©å­ä»¬æ²¡æœ‰é•¿å¤§ï¼Œå§¿åŠ¿å®Œå…¨ç›¸åŒ",
                "supporters": "éƒ¨åˆ†è§‚ä¼—"
            },
            {
                "theory": "Cobbå›åˆ°ç°å®",
                "reasoning": "é™€èºå¼€å§‹æ™ƒåŠ¨ï¼Œæš—ç¤ºä¼šåœä¸‹",
                "supporters": "éƒ¨åˆ†è§‚ä¼—"
            }
        ],
        "director_intent": "è¯ºå…°å¸Œæœ›è§‚ä¼—è‡ªå·±å†³å®šç­”æ¡ˆ",
        "thematic_meaning": "ç°å®ä¸æ¢¦å¢ƒç•Œé™æ¨¡ç³Šï¼Œä¸»é¢˜æ˜¯é€‰æ‹©ç›¸ä¿¡ä»€ä¹ˆ"
    },
    "answer": "ã€Šç›—æ¢¦ç©ºé—´ã€‹çš„ç»“å±€æ˜¯å¼€æ”¾å¼çš„...",
    "confidence": "medium",
    "sources": [
        {"type": "interview", "author": "å…‹é‡Œæ–¯æ‰˜å¼—Â·è¯ºå…°"},
        {"type": "film_analysis", "platform": "è±†ç“£å½±è¯„"}
    ]
}
```

**Agenté€‰æ‹©**ï¼š`MovieQAAgent` (FusionGraphRAG)
**æ£€ç´¢ç­–ç•¥**ï¼šå¤šæºä¿¡æ¯èšåˆ + åˆ†ææ¨ç†

---

#### 4.2 ä¸»é¢˜åˆ†æ (Thematic Analysis)

**é—®é¢˜ç¤ºä¾‹**ï¼š
- "ã€Šæ¥šé—¨çš„ä¸–ç•Œã€‹æƒ³è¡¨è¾¾ä»€ä¹ˆï¼Ÿ"
- "è¯ºå…°ç”µå½±çš„å…±åŒä¸»é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ"
- "ã€Šå¯„ç”Ÿè™«ã€‹åæ˜ äº†ä»€ä¹ˆç¤¾ä¼šé—®é¢˜"

**è¯æ®éœ€æ±‚**ï¼š
```python
{
    "movie": "æ¥šé—¨çš„ä¸–ç•Œ",
    "themes": {
        "primary": ["è‡ªç”±", "çœŸå®ä¸è™šå‡", "åª’ä½“æ“æ§"],
        "symbolism": ["æ‘„å½±æœº", "Exité—¨"],
        "social_context": ["çœŸäººç§€æ–‡åŒ–", "æ¶ˆè´¹ä¸»ä¹‰"]
    },
    "analysis_depth": "deep"
}
```

**è¾“å‡ºç»“æ„**ï¼š
```json
{
    "type": "thematic_analysis",
    "movie": "æ¥šé—¨çš„ä¸–ç•Œ",
    "themes": [
        {
            "theme": "è‡ªç”±æ„å¿—",
            "explanation": "æ¥šé—¨æœ€ç»ˆé€‰æ‹©ç¦»å¼€è™šå‡ä¸–ç•Œï¼Œè¿½æ±‚çœŸå®è‡ªç”±",
            "supporting_scenes": [
                "æ¥šé—¨å…‹æœå¯¹æ°´çš„ææƒ§",
                "æœ€ç»ˆè§¦ç¢°Exité—¨"
            ],
            "symbolism": "èˆ¹è±¡å¾çªç ´æŸç¼šï¼ŒExité—¨è±¡å¾è‡ªç”±é€‰æ‹©"
        },
        {
            "theme": "çœŸå®ä¸è™šå‡",
            "explanation": "ç”µå½±æ¢è®¨ä»€ä¹ˆæ˜¯çœŸå®ï¼Œäººé€ çš„ç”Ÿæ´»æ˜¯å¦å€¼å¾—",
            "philosophical_context": "æŸæ‹‰å›¾æ´ç©´å¯“è¨€çš„ç°ä»£æ¼”ç»"
        },
        {
            "theme": "åª’ä½“æ“æ§",
            "explanation": "æ‰¹åˆ¤çœŸäººç§€æ–‡åŒ–å¯¹éšç§çš„ä¾µçŠ¯",
            "social_relevance": "é¢„ç¤ºäº†å½“ä»£ç¤¾äº¤åª’ä½“æ—¶ä»£çš„éšç§é—®é¢˜"
        }
    ],
    "artistic_techniques": [
        "æ‰“ç ´ç¬¬å››é¢å¢™ï¼ˆè§‚ä¼—è§‚çœ‹è§‚ä¼—ï¼‰",
        "ä¸Šå¸è§†è§’ï¼ˆå¯¼æ¼”ä½œä¸ºæ“æ§è€…ï¼‰"
    ],
    "answer": "ã€Šæ¥šé—¨çš„ä¸–ç•Œã€‹é€šè¿‡çœŸäººç§€çš„è®¾å®šï¼Œæ¢è®¨äº†è‡ªç”±æ„å¿—ã€çœŸå®ä¸è™šå‡ç­‰ä¸»é¢˜..."
}
```

**Agenté€‰æ‹©**ï¼š`MovieQAAgent`
**æ£€ç´¢ç­–ç•¥**ï¼šæ·±åº¦åˆ†æ + ä¸»é¢˜æå–

---

#### 4.3 å½©è›‹è§£æ (Easter Egg Analysis)

**é—®é¢˜ç¤ºä¾‹**ï¼š
- "æ¼«å¨ç”µå½±æœ‰å“ªäº›å½©è›‹ï¼Ÿ"
- "ã€Šå¤´å·ç©å®¶ã€‹é‡Œçš„å½©è›‹å…¨è§£è¯»"
- "ã€Šç©å…·æ€»åŠ¨å‘˜ã€‹æœ‰å“ªäº›çš®å…‹æ–¯å½©è›‹"

**è¯æ®éœ€æ±‚**ï¼š
```python
{
    "movie": "å¤´å·ç©å®¶",
    "easter_eggs": {
        "pop_culture_refs": [
            "é‡‘åˆš", "é«˜è¾¾", "è™è ä¾ "
        ],
        "hidden_details": [
            "èƒŒæ™¯é‡Œçš„æµ·æŠ¥",
            "è§’è‰²çš„å°è¯"
        ]
    }
}
```

**è¾“å‡ºç»“æ„**ï¼š
```json
{
    "type": "easter_egg_analysis",
    "movie": "å¤´å·ç©å®¶",
    "easter_eggs": [
        {
            "category": "æµè¡Œæ–‡åŒ–è‡´æ•¬",
            "eggs": [
                {
                    "reference": "é‡‘åˆš",
                    "scene": "å¼€åœºå¤§æˆ˜",
                    "detail": "ç»å…¸é‡‘åˆšå¯¹æˆ˜é£æœºåœºæ™¯"
                },
                {
                    "reference": "é«˜è¾¾",
                    "scene": "æœ€ç»ˆå†³æˆ˜",
                    "detail": "ä¸»è§’é©¾é©¶é«˜è¾¾RX-78-2"
                }
            ]
        },
        {
            "category": "æ–¯çš®å°”ä¼¯æ ¼è‡ªæˆ‘è‡´æ•¬",
            "eggs": [
                {
                    "reference": "å›åˆ°æœªæ¥",
                    "scene": "èµ›è½¦åœºæ™¯",
                    "detail": "æ—¶é—´æœºå™¨DMC-12å‡ºç°åœ¨èƒŒæ™¯"
                }
            ]
        }
    ],
    "answer": "ã€Šå¤´å·ç©å®¶ã€‹å……æ»¡äº†80å¹´ä»£æµè¡Œæ–‡åŒ–å½©è›‹..."
}
```

**Agenté€‰æ‹©**ï¼š`MovieQAAgent`
**æ£€ç´¢ç­–ç•¥**ï¼šç»†èŠ‚æ£€ç´¢ + åˆ†ç±»æ•´ç†

---

### ç±»å‹ 5ï¸âƒ£ï¼šå¯¹æ¯”åˆ†æç±» (Comparison)

**ç”¨æˆ·æ„å›¾**ï¼šæ¯”è¾ƒä¸¤éƒ¨ç”µå½±æˆ–å¤šéƒ¨ä½œå“çš„å¼‚åŒ

---

#### 5.1 ä¸¤éƒ¨ç”µå½±å¯¹æ¯” (Two Movies Comparison)

**é—®é¢˜ç¤ºä¾‹**ï¼š
- "ã€Šæ˜Ÿé™…ç©¿è¶Šã€‹å’Œã€Š2001å¤ªç©ºæ¼«æ¸¸ã€‹å“ªä¸ªæ›´å¥½ï¼Ÿ"
- "è¯ºå…°çš„ã€Šè™è ä¾ ã€‹å’Œæ¼«ç”»åŸç‰ˆæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"
- "ã€Šæµæµªåœ°çƒã€‹å’Œã€Šæ˜Ÿé™…ç©¿è¶Šã€‹ç§‘å¹»è§‚å·®å¼‚"

**è¯æ®éœ€æ±‚**ï¼š
```python
{
    "movie_a": "æ˜Ÿé™…ç©¿è¶Š",
    "movie_b": "2001å¤ªç©ºæ¼«æ¸¸",
    "comparison_dimensions": [
        "scientific_accuracy",
        "visual_effects",
        "storytelling",
        "philosophical_depth"
    ]
}
```

**è¾“å‡ºç»“æ„**ï¼š
```json
{
    "type": "movie_comparison",
    "movies": [
        {
            "title": "æ˜Ÿé™…ç©¿è¶Š",
            "year": 2014,
            "director": "å…‹é‡Œæ–¯æ‰˜å¼—Â·è¯ºå…°"
        },
        {
            "title": "2001å¤ªç©ºæ¼«æ¸¸",
            "year": 1968,
            "director": "æ–¯å¦åˆ©Â·åº“å¸ƒé‡Œå…‹"
        }
    ],
    "comparison": {
        "similarities": [
            {
                "dimension": "ä¸»é¢˜",
                "description": "éƒ½æ¢è®¨äººç±»åœ¨å®‡å®™ä¸­çš„ä½ç½®",
                "examples": ["å¤ªç©ºæ¢ç´¢", "äººå·¥æ™ºèƒ½", "äººç±»è¿›åŒ–"]
            },
            {
                "dimension": "è§†è§‰é£æ ¼",
                "description": "éƒ½å¼ºè°ƒç§‘å­¦çœŸå®æ„Ÿå’Œè§†è§‰éœ‡æ’¼"
            }
        ],
        "differences": [
            {
                "dimension": "å™äº‹æ–¹å¼",
                "interstellar": "æƒ…æ„Ÿé©±åŠ¨ï¼Œçˆ¶å¥³æƒ…æ„Ÿçº¿",
                "space_2001": "å“²å­¦é©±åŠ¨ï¼ŒæŠ½è±¡æ™¦æ¶©"
            },
            {
                "dimension": "ç§‘å­¦æ€§",
                "interstellar": "åŸºäºç†è®ºç‰©ç†ï¼ˆè™«æ´ã€é»‘æ´ï¼‰",
                "space_2001": "æ›´å…·é¢„è¨€æ€§å’Œè±¡å¾æ€§"
            },
            {
                "dimension": "æ—¶ä»£èƒŒæ™¯",
                "interstellar": "21ä¸–çºªè§†è§’ï¼Œå…³æ³¨æ°”å€™å˜åŒ–",
                "space_2001": "å†·æˆ˜æ—¶æœŸï¼Œå…³æ³¨äººå·¥æ™ºèƒ½å¨èƒ"
            }
        ]
    },
    "verdict": {
        "subjective": "ä¸¤è€…å„æœ‰ç‰¹è‰²ï¼Œé€‰æ‹©å–å†³äºä¸ªäººåå¥½",
        "recommendation": {
            "å–œæ¬¢æƒ…æ„Ÿå™äº‹": "æ˜Ÿé™…ç©¿è¶Š",
            "å–œæ¬¢å“²å­¦æ€è¾¨": "2001å¤ªç©ºæ¼«æ¸¸"
        }
    },
    "answer": "ã€Šæ˜Ÿé™…ç©¿è¶Šã€‹å’Œã€Š2001å¤ªç©ºæ¼«æ¸¸ã€‹éƒ½æ˜¯ç§‘å¹»ç»å…¸ï¼Œä½†é£æ ¼è¿¥å¼‚..."
}
```

**Agenté€‰æ‹©**ï¼š`MovieQAAgent`
**æ£€ç´¢ç­–ç•¥**ï¼šåŒå®ä½“æ£€ç´¢ + å¯¹æ¯”ç»´åº¦åˆ†æ

---

#### 5.2 å¤šç»´åº¦å¯¹æ¯” (Multi-dimensional Comparison)

**é—®é¢˜ç¤ºä¾‹**ï¼š
- "æ¼«å¨å’ŒDCè¶…çº§è‹±é›„ç”µå½±æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"
- "è¯ºå…°ä¸‰éƒ¨æ›²å’Œåæ¥çš„ã€Šè™è ä¾ ã€‹é‡å¯ç‰ˆå¯¹æ¯”"
- "ä¸­å›½ç§‘å¹»ç”µå½±å’Œå¥½è±åçš„å·®å¼‚"

**è¯æ®éœ€æ±‚**ï¼š
```python
{
    "comparison_scope": {
        "type": "franchise",  # ç³»åˆ—ç”µå½±å¯¹æ¯”
        "subjects": ["æ¼«å¨ç”µå½±å®‡å®™", "DCæ‰©å±•å®‡å®™"]
    },
    "dimensions": [
        "tone",
        "cinematography",
        "character_development",
        "box_office_performance",
        "critical_reception"
    ]
}
```

**è¾“å‡ºç»“æ„**ï¼š
```json
{
    "type": "multi_dimensional_comparison",
    "subjects": ["æ¼«å¨ç”µå½±å®‡å®™", "DCæ‰©å±•å®‡å®™"],
    "dimensions": [
        {
            "dimension": "æ•´ä½“åŸºè°ƒ",
            "marvel": "è½»æ¾å¹½é»˜ï¼Œåˆå®¶æ¬¢",
            "dc": "é»‘æš—ä¸¥è‚ƒï¼Œæˆäººå‘"
        },
        {
            "dimension": "ç”µå½±å®‡å®™è§„åˆ’",
            "marvel": "é•¿æœŸè§„åˆ’ï¼Œé˜¶æ®µå¼å‘å±•",
            "dc": "ç¼ºä¹æ•´ä½“è§„åˆ’ï¼Œåå¤é‡å¯"
        },
        {
            "dimension": "ç¥¨æˆ¿è¡¨ç°",
            "marvel": {
                "avg_box_office": "10äº¿ç¾å…ƒ",
                "top_movie": "å¤ä»‡è€…è”ç›Ÿ4"
            },
            "dc": {
                "avg_box_office": "8äº¿ç¾å…ƒ",
                "top_movie": "æµ·ç‹"
            }
        },
        {
            "dimension": "å½±è¯„å£ç¢‘",
            "marvel": {
                "avg_rating": 7.8,
                "consistency": "ç¨³å®š"
            },
            "dc": {
                "avg_rating": 7.2,
                "consistency": "ä¸¤æåˆ†åŒ–"
            }
        }
    ],
    "summary": "æ¼«å¨åœ¨å•†ä¸šæˆåŠŸå’Œå®‡å®™è§„åˆ’ä¸Šæ›´èƒœä¸€ç­¹ï¼ŒDCåœ¨ä¸ªåˆ«ä½œå“ï¼ˆå¦‚ã€Šé»‘æš—éª‘å£«ã€‹ï¼‰ä¸Šæœ‰æ›´é«˜è‰ºæœ¯æˆå°±...",
    "answer": "æ¼«å¨å’ŒDCçš„è¶…çº§è‹±é›„ç”µå½±åœ¨å¤šä¸ªç»´åº¦ä¸Šå­˜åœ¨æ˜¾è‘—å·®å¼‚..."
}
```

**Agenté€‰æ‹©**ï¼š`MovieQAAgent`
**æ£€ç´¢ç­–ç•¥**ï¼šèšåˆæ£€ç´¢ + å¯¹æ¯”åˆ†æ

---

### ç±»å‹ 6ï¸âƒ£ï¼šå…³è”æ¨ç†ç±» (Reasoning)

**ç”¨æˆ·æ„å›¾**ï¼šåŸºäºçŸ¥è¯†å›¾è°±è¿›è¡Œå¤æ‚æ¨ç†

---

#### 6.1 å›¾è°±æ¨ç† (KG Reasoning)

**é—®é¢˜ç¤ºä¾‹**ï¼š
- "ä¸ºä»€ä¹ˆè¯´è¯ºå…°æ˜¯"æ—¶é—´é­”æœ¯å¸ˆ"ï¼Ÿ"
- "ä»ã€Šæ•™çˆ¶ã€‹åˆ°ã€Šé»‘é“å®¶æ—ã€‹æœ‰ä»€ä¹ˆå½±å“å…³ç³»ï¼Ÿ"
- "æ¼«å¨ç”µå½±å¦‚ä½•è¿æ¥åˆ°ã€Šå¤ä»‡è€…è”ç›Ÿã€‹ï¼Ÿ"

**è¯æ®éœ€æ±‚**ï¼š
```python
{
    "query": "è¯ºå…°ä¸ºä»€ä¹ˆè¢«ç§°ä¸ºæ—¶é—´é­”æœ¯å¸ˆ",
    "reasoning_paths": [
        "è¯ºå…° â†’ [ä½œå“] â†’ ç›—æ¢¦ç©ºé—´ â†’ [ä¸»é¢˜: æ—¶é—´] â†’ å¤šå±‚æ¢¦å¢ƒæ—¶é—´",
        "è¯ºå…° â†’ [ä½œå“] â†’ è‡´å‘½é­”æœ¯ â†’ [ä¸»é¢˜: æ—¶é—´] â†’ åŒé‡æ—¶é—´çº¿",
        "è¯ºå…° â†’ [ä½œå“] â†’ ä¿¡æ¡ â†’ [ä¸»é¢˜: æ—¶é—´] â†’ æ—¶é—´é€†è½¬",
        "è¯ºå…° â†’ [ä½œå“] â†’ æ˜Ÿé™…ç©¿è¶Š â†’ [ä¸»é¢˜: æ—¶é—´] â†’ ç›¸å¯¹è®ºæ—¶é—´è†¨èƒ€",
        "è¯ºå…° â†’ [ä½œå“] â†’ å¥¥æœ¬æµ·é»˜ â†’ [ä¸»é¢˜: æ—¶é—´] â†’ éçº¿æ€§å™äº‹"
    ],
    "inference": "è¯ºå…°çš„å¤šéƒ¨ä½œå“éƒ½å›´ç»•æ—¶é—´æ¦‚å¿µå±•å¼€"
}
```

**è¾“å‡ºç»“æ„**ï¼š
```json
{
    "type": "kg_reasoning",
    "question": "ä¸ºä»€ä¹ˆè¯´è¯ºå…°æ˜¯"æ—¶é—´é­”æœ¯å¸ˆ"ï¼Ÿ",
    "reasoning_process": {
        "step_1": {
            "action": "æ£€ç´¢è¯ºå…°æ‰€æœ‰ä½œå“",
            "result": ["è‡´å‘½é­”æœ¯", "ç›—æ¢¦ç©ºé—´", "æ˜Ÿé™…ç©¿è¶Š", "ä¿¡æ¡", "å¥¥æœ¬æµ·é»˜"]
        },
        "step_2": {
            "action": "æå–æ¯éƒ¨ä½œå“çš„æ—¶é—´ä¸»é¢˜",
            "findings": [
                {"movie": "è‡´å‘½é­”æœ¯", "time_concept": "åŒé‡æ—¶é—´çº¿"},
                {"movie": "ç›—æ¢¦ç©ºé—´", "time_concept": "å¤šå±‚æ¢¦å¢ƒæ—¶é—´"},
                {"movie": "æ˜Ÿé™…ç©¿è¶Š", "time_concept": "ç›¸å¯¹è®ºæ—¶é—´è†¨èƒ€"},
                {"movie": "ä¿¡æ¡", "time_concept": "æ—¶é—´é€†è½¬"},
                {"movie": "å¥¥æœ¬æµ·é»˜", "time_concept": "éçº¿æ€§å™äº‹"}
            ]
        },
        "step_3": {
            "action": "å½’çº³å…±åŒç‚¹",
            "conclusion": "è¯ºå…°ä½œå“ä¸­åå¤å‡ºç°å¤æ‚çš„æ—¶é—´æ¦‚å¿µ"
        }
    },
    "kg_paths": [
        "è¯ºå…° â†’ è‡´å‘½é­”æœ¯ â†’ åŒé‡æ—¶é—´çº¿ â†’ æ—¶é—´é­”æœ¯",
        "è¯ºå…° â†’ ç›—æ¢¦ç©ºé—´ â†’ æ¢¦å¢ƒæ—¶é—´ â†’ æ—¶é—´é­”æœ¯",
        "è¯ºå…° â†’ æ˜Ÿé™…ç©¿è¶Š â†’ æ—¶é—´è†¨èƒ€ â†’ æ—¶é—´é­”æœ¯",
        "è¯ºå…° â†’ ä¿¡æ¡ â†’ æ—¶é—´é€†è½¬ â†’ æ—¶é—´é­”æœ¯",
        "è¯ºå…° â†’ å¥¥æœ¬æµ·é»˜ â†’ éçº¿æ€§ â†’ æ—¶é—´é­”æœ¯"
    ],
    "conclusion": {
        "main_reason": "è¯ºå…°å¤šéƒ¨ä½œå“éƒ½ä»¥å¤æ‚çš„æ—¶é—´æ¦‚å¿µä¸ºæ ¸å¿ƒ",
        "examples": "åˆ—ä¸¾5éƒ¨ç”µå½±çš„æ—¶é—´ä¸»é¢˜",
        "critical_reception": "å½±è¯„äººç§°å…¶ä¸º"æ—¶é—´çš„é­”æœ¯å¸ˆ"",
        "significance": "æ—¶é—´æˆä¸ºè¯ºå…°ç”µå½±çš„æ ‡å¿—æ€§å…ƒç´ "
    },
    "answer": "è¯ºå…°è¢«ç§°ä¸º"æ—¶é—´é­”æœ¯å¸ˆ"æ˜¯å› ä¸ºä»–çš„å¤šéƒ¨ä½œå“â€”â€”ä»ã€Šè‡´å‘½é­”æœ¯ã€‹çš„åŒé‡æ—¶é—´çº¿ã€ã€Šç›—æ¢¦ç©ºé—´ã€‹çš„å¤šå±‚æ¢¦å¢ƒæ—¶é—´ã€ã€Šæ˜Ÿé™…ç©¿è¶Šã€‹çš„ç›¸å¯¹è®ºæ—¶é—´è†¨èƒ€ã€ã€Šä¿¡æ¡ã€‹çš„æ—¶é—´é€†è½¬ï¼Œåˆ°ã€Šå¥¥æœ¬æµ·é»˜ã€‹çš„éçº¿æ€§å™äº‹â€”â€”éƒ½å›´ç»•å¤æ‚çš„æ—¶é—´æ¦‚å¿µå±•å¼€..."
}
```

**Agenté€‰æ‹©**ï¼š`MovieQAAgent` (æ·±åº¦ç ”ç©¶æ¨¡å¼)
**æ£€ç´¢ç­–ç•¥**ï¼šå¤šè·³æŸ¥è¯¢ + è·¯å¾„æ¨ç† + å½’çº³æ€»ç»“

---

#### 6.2 å› æœæ¨ç† (Causal Reasoning)

**é—®é¢˜ç¤ºä¾‹**ï¼š
- "ã€Šè´¾ä¼¯æ–¯ã€‹ä¸ºä»€ä¹ˆç¥¨æˆ¿å¤±è´¥ï¼Ÿ"
- "ã€Šé»‘æš—éª‘å£«ã€‹çš„æˆåŠŸå¦‚ä½•å½±å“åæ¥çš„è¶…çº§è‹±é›„ç”µå½±ï¼Ÿ"
- "è¯ºå…°ç”µå½±çš„æˆåŠŸå› ç´ æ˜¯ä»€ä¹ˆï¼Ÿ"

**è¯æ®éœ€æ±‚**ï¼š
```python
{
    "effect": "é»‘æš—éª‘å£«ç¥¨æˆ¿æˆåŠŸ",
    "causes": [
        {
            "factor": "å¸Œæ–¯Â·è±æ°çš„è¡¨æ¼”",
            "evidence": "å¥¥æ–¯å¡æœ€ä½³ç”·é…è§’"
        },
        {
            "factor": "å†™å®é£æ ¼",
            "evidence": "å½±è¯„å’Œè§‚ä¼—åé¦ˆ"
        },
        {
            "factor": "ä¸Šæ˜ æ—¶æœº",
            "evidence": "2008å¹´ç¤¾ä¼šèƒŒæ™¯"
        }
    ],
    "impacts": [
        "æ¨åŠ¨è¶…çº§è‹±é›„ç”µå½±èµ°å‘æˆäººåŒ–",
        "è¯æ˜æ¼«ç”»ç”µå½±å¯ä»¥è‰ºæœ¯åŒ–",
        "å½±å“åç»­DCç”µå½±é£æ ¼"
    ]
}
```

**è¾“å‡ºç»“æ„**ï¼š
```json
{
    "type": "causal_analysis",
    "question": "ã€Šé»‘æš—éª‘å£«ã€‹çš„æˆåŠŸå¦‚ä½•å½±å“åæ¥çš„è¶…çº§è‹±é›„ç”µå½±ï¼Ÿ",
    "success_factors": [
        {
            "factor": "å¸Œæ–¯Â·è±æ°çš„å°ä¸‘è¡¨æ¼”",
            "importance": "critical",
            "evidence": "å¥¥æ–¯å¡æœ€ä½³ç”·é…è§’",
            "impact": "è¯æ˜æ¼«ç”»ç”µå½±è§’è‰²å¯ä»¥è·ä¸»æµè®¤å¯"
        },
        {
            "factor": "å†™å®é»‘æš—é£æ ¼",
            "importance": "high",
            "evidence": "å½±è¯„åˆ†æ",
            "impact": "æ‰“ç ´"æ¼«ç”»ç”µå½±=å„¿ç«¥å‘"çš„åè§"
        },
        {
            "factor": "å™äº‹æ·±åº¦",
            "importance": "medium",
            "evidence": "ä¸»é¢˜åˆ†æ",
            "impact": "è¶…çº§è‹±é›„å¯ä»¥æ¢è®¨ä¸¥è‚ƒè®®é¢˜"
        }
    ],
    "impacts_on_later_movies": [
        {
            "impact_type": "é£æ ¼å½±å“",
            "examples": [
                "ã€Šå¤ä»‡è€…è”ç›Ÿã€‹å¢åŠ ä¸¥è‚ƒå…ƒç´ ",
                "ã€Šé‡‘åˆšç‹¼ã€‹ç³»åˆ—é‡‡ç”¨Rçº§",
                "ã€Šæµ·ç‹ã€‹å°è¯•æ›´æˆç†Ÿå™äº‹"
            ]
        },
        {
            "impact_type": "äº§ä¸šå½±å“",
            "examples": [
                "æ¼«ç”»ç”µå½±æŠ•èµ„å¢åŠ ",
                "å¸å¼•ä¸¥è‚ƒæ¼”å‘˜å‚æ¼”",
                "æ¼«ç”»ç”µå½±è·å¾—å¥¥æ–¯å¡è®¤å¯"
            ]
        }
    ],
    "answer": "ã€Šé»‘æš—éª‘å£«ã€‹çš„æˆåŠŸé€šè¿‡å¤šä¸ªæ–¹é¢å½±å“äº†åæ¥çš„è¶…çº§è‹±é›„ç”µå½±..."
}
```

**Agenté€‰æ‹©**ï¼š`MovieQAAgent` (DeepResearchæ¨¡å¼)
**æ£€ç´¢ç­–ç•¥**ï¼šå¤šæºä¿¡æ¯èšåˆ + å› æœé“¾åˆ†æ

---

## ä¸‰ã€åˆ†ç±»åˆ¤æ–­é€»è¾‘

### 3.1 æ„å›¾è¯†åˆ«è§„åˆ™

```python
def classify_question(question: str) -> Dict[str, Any]:
    """é—®é¢˜åˆ†ç±»å™¨"""

    # è§„åˆ™1: å…³é”®è¯åŒ¹é…
    keywords = {
        "fact_query": ["æ˜¯è°", "æ˜¯ä»€ä¹ˆ", "å“ªäº›", "å¤šå°‘", "æ’å"],
        "recommendation": ["æ¨è", "å¥½çœ‹çš„", "å€¼å¾—çœ‹", "è¿˜æœ‰ä»€ä¹ˆ"],
        "similarity": ["ç±»ä¼¼", "ç›¸ä¼¼", "åƒ", "å’ŒXXä¸€æ ·"],
        "analysis": ["ç»“å±€", "æ„æ€", "ä¸»é¢˜", "è¡¨è¾¾", "å½©è›‹"],
        "comparison": ["å’ŒXXæ¯”", "åŒºåˆ«", "å·®å¼‚", "å“ªä¸ªå¥½"],
        "reasoning": ["ä¸ºä»€ä¹ˆ", "å¦‚ä½•å½±å“", "å› æœå…³ç³»"]
    }

    # è§„åˆ™2: å¥å¼æ¨¡å¼
    patterns = {
        "list_query": r"(æœ‰å“ªäº›|å“ªäº›ç”µå½±|æ‰€æœ‰.*)",
        "open_recommendation": r"(ç»™æˆ‘æ¨è|ä»Šæ™šçœ‹ä»€ä¹ˆ|çœ‹ä»€ä¹ˆå¥½)",
        "similarity": r"(å’Œ.*ç±»ä¼¼|åƒ.*|ç±»ä¼¼.*çš„)",
        "comparison": r"(å’Œ.*æ¯”|.*vs.*|å“ªä¸ªå¥½)"
    }

    # è§„åˆ™3: ä¸Šä¸‹æ–‡æ¨æ–­
    context = {
        "has_entity": extract_movie_entities(question),
        "has_constraints": extract_constraints(question),
        "has_rating": check_rating_keywords(question),
        "has_scenario": check_scenario_keywords(question)
    }

    # ç»¼åˆåˆ¤æ–­
    return {
        "type": determine_type(keywords, patterns, context),
        "subtype": determine_subtype(keywords, patterns, context),
        "confidence": calculate_confidence(),
        "agent": select_agent(type, subtype),
        "evidence_needs": get_evidence_requirements(type, subtype)
    }
```

### 3.2 Agenté€‰æ‹©çŸ©é˜µ

| é—®é¢˜ç±»å‹ | å­ç±»å‹ | Agent | æ£€ç´¢ç­–ç•¥ |
|---------|-------|-------|---------|
| äº‹å®æŸ¥è¯¢ | å®ä½“æŸ¥è¯¢ | GraphAgent | å®ä½“+1è·³å…³ç³» |
| äº‹å®æŸ¥è¯¢ | åˆ—ä¸¾æŸ¥è¯¢ | PrecisionSearchAgent | ç»“æ„åŒ–æŸ¥è¯¢+è¿‡æ»¤ |
| äº‹å®æŸ¥è¯¢ | æ•°æ®æŸ¥è¯¢ | GraphAgent+TMDB | å±æ€§æŸ¥è¯¢+å®æ—¶æ•°æ® |
| æ¨èå‘ç° | å¼€æ”¾æ¨è | PersonalizedRecAgent | ç”¨æˆ·ç”»åƒ+å¤šç­–ç•¥ |
| æ¨èå‘ç° | çº¦æŸæ¨è | ExploratorySearchAgent | è¿‡æ»¤å™¨+ç”»åƒ |
| æ¨èå‘ç° | åœºæ™¯æ¨è | ExploratorySearchAgent | åœºæ™¯æ˜ å°„+è§„åˆ™ |
| ç›¸ä¼¼æ¨è | ç”µå½±ç›¸ä¼¼ | SimilarityRecAgent | å¤šç»´åº¦ç›¸ä¼¼åº¦+KG |
| ç›¸ä¼¼æ¨è | è·¨æ¨¡æ€ç›¸ä¼¼ | SimilarityRecAgent | è·¨æ¨¡æ€æ˜ å°„ |
| å†…å®¹è§£æ | å‰§æƒ…è§£æ | MovieQAAgent | å¤šæºèšåˆ+æ¨ç† |
| å†…å®¹è§£æ | ä¸»é¢˜åˆ†æ | MovieQAAgent | æ·±åº¦åˆ†æ+æå– |
| å†…å®¹è§£æ | å½©è›‹è§£æ | MovieQAAgent | ç»†èŠ‚æ£€ç´¢+åˆ†ç±» |
| å¯¹æ¯”åˆ†æ | ä¸¤éƒ¨å¯¹æ¯” | MovieQAAgent | åŒå®ä½“+å¯¹æ¯” |
| å¯¹æ¯”åˆ†æ | å¤šç»´å¯¹æ¯” | MovieQAAgent | èšåˆ+å¯¹æ¯” |
| å…³è”æ¨ç† | å›¾è°±æ¨ç† | MovieQAAgent(Deep) | å¤šè·³+è·¯å¾„+å½’çº³ |
| å…³è”æ¨ç† | å› æœæ¨ç† | MovieQAAgent(Deep) | å¤šæº+å› æœé“¾ |

---

## å››ã€è¾“å‡ºæ ¼å¼æ ‡å‡†åŒ–

### 4.1 é€šç”¨å“åº”ç»“æ„

```json
{
    "query": {
        "original": "ç”¨æˆ·åŸå§‹é—®é¢˜",
        "type": "é—®é¢˜ç±»å‹",
        "subtype": "å­ç±»å‹",
        "understanding": "æŸ¥è¯¢ç†è§£ç»“æœ"
    },
    "answer": {
        "content": "ä¸»è¦å›ç­”å†…å®¹",
        "format": "markdown/text/json",
        "length": "short/medium/long"
    },
    "evidence": {
        "sources": ["æ¥æºåˆ—è¡¨"],
        "references": ["å¼•ç”¨æ•°æ®"],
        "confidence": 0.95
    },
    "metadata": {
        "agent_used": "ä½¿ç”¨çš„Agent",
        "retrieval_strategy": "æ£€ç´¢ç­–ç•¥",
        "processing_time": "è€—æ—¶",
        "user_profile_applied": true/false
    }
}
```

### 4.2 ä¸åŒç±»å‹çš„ç‰¹æ®Šå­—æ®µ

```python
SPECIAL_FIELDS = {
    "fact_query": {
        "fact_data": "äº‹å®æ•°æ®",
        "sources": ["æ¥æºåˆ—è¡¨"]
    },
    "recommendation": {
        "recommendations": ["æ¨èåˆ—è¡¨"],
        "reason_for_each": "æ¨èç†ç”±",
        "personalization": "ä¸ªæ€§åŒ–ä¾æ®"
    },
    "similarity": {
        "similarity_scores": "ç›¸ä¼¼åº¦åˆ†æ•°",
        "similarity_breakdown": "å¤šç»´åº¦åˆ†è§£",
        "kg_paths": "å›¾è°±è·¯å¾„"
    },
    "analysis": {
        "analysis_depth": "åˆ†ææ·±åº¦",
        "alternative_views": "ä¸åŒè§‚ç‚¹",
        "confidence_level": "ç½®ä¿¡åº¦"
    },
    "comparison": {
        "comparison_table": "å¯¹æ¯”è¡¨æ ¼",
        "similarities": "ç›¸ä¼¼ç‚¹",
        "differences": "ä¸åŒç‚¹"
    },
    "reasoning": {
        "reasoning_steps": "æ¨ç†æ­¥éª¤",
        "logical_chain": "é€»è¾‘é“¾",
        "conclusion": "ç»“è®º"
    }
}
```

---

## äº”ã€å®æ–½ä¼˜å…ˆçº§

### P0 - æ ¸å¿ƒç±»å‹ï¼ˆç«‹å³å®ç°ï¼‰
1. âœ… **äº‹å®æŸ¥è¯¢ç±»**ï¼ˆå·²åŸºæœ¬è¦†ç›–ï¼‰
   - å®ä½“æŸ¥è¯¢ã€åˆ—ä¸¾æŸ¥è¯¢ã€æ•°æ®æŸ¥è¯¢

2. âœ… **ç›¸ä¼¼æ¨èç±»**ï¼ˆéƒ¨åˆ†è¦†ç›–ï¼‰
   - ç”µå½±ç›¸ä¼¼ï¼ˆéœ€è¦å¢å¼ºï¼‰

### P1 - é‡è¦ç±»å‹ï¼ˆè¿‘æœŸå®ç°ï¼‰
3. ğŸŸ¡ **æ¨èå‘ç°ç±»**ï¼ˆéƒ¨åˆ†ç¼ºå¤±ï¼‰
   - å¼€æ”¾æ¨èï¼ˆéœ€è¦PersonalizedRecAgentï¼‰
   - çº¦æŸæ¨èï¼ˆéœ€è¦å¢å¼ºè¿‡æ»¤å™¨ï¼‰
   - åœºæ™¯æ¨èï¼ˆéœ€è¦åœºæ™¯è¯†åˆ«ï¼‰

4. ğŸŸ¡ **å†…å®¹è§£æç±»**ï¼ˆéƒ¨åˆ†è¦†ç›–ï¼‰
   - å‰§æƒ…è§£æã€ä¸»é¢˜åˆ†æã€å½©è›‹è§£æ

### P2 - é«˜çº§ç±»å‹ï¼ˆä¸­æœŸå®ç°ï¼‰
5. ğŸ”´ **å¯¹æ¯”åˆ†æç±»**ï¼ˆéœ€è¦æ–°å»ºï¼‰
   - ä¸¤éƒ¨ç”µå½±å¯¹æ¯”ã€å¤šç»´åº¦å¯¹æ¯”

6. ğŸ”´ **å…³è”æ¨ç†ç±»**ï¼ˆéœ€è¦å¢å¼ºï¼‰
   - å›¾è°±æ¨ç†ã€å› æœæ¨ç†

---

## å…­ã€ä¸‹ä¸€æ­¥

**å»ºè®®å®æ–½é¡ºåº**ï¼š

1. **å®Œå–„åˆ†ç±»å™¨**ï¼šå®ç°é—®é¢˜ç±»å‹è‡ªåŠ¨è¯†åˆ«
2. **å®šä¹‰è¾“å‡ºSchema**ï¼šä¸ºæ¯ç§ç±»å‹å®šä¹‰JSON Schema
3. **å¢å¼ºç°æœ‰Agent**ï¼šåŸºäºåˆ†ç±»ç»“æœä¼˜åŒ–Agent
4. **å®ç°ç¼ºå¤±Agent**ï¼šPersonalizedRecAgentç­‰
5. **æµ‹è¯•éªŒè¯**ï¼šæ¯ç§ç±»å‹å‡†å¤‡æµ‹è¯•ç”¨ä¾‹

**é—®é¢˜**ï¼šä½ å¸Œæœ›ä»å“ªä¸ªé—®é¢˜ç±»å‹å¼€å§‹å®ç°ï¼Ÿ
- A. äº‹å®æŸ¥è¯¢ï¼ˆä¼˜åŒ–ç°æœ‰ï¼‰
- B. æ¨èå‘ç°ï¼ˆå…¨æ–°å®ç°ï¼‰
- C. ç›¸ä¼¼æ¨èï¼ˆå¢å¼ºç°æœ‰ï¼‰
- D. å†…å®¹è§£æï¼ˆä¼˜åŒ–ç°æœ‰ï¼‰
